<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Ø±ÙÙŠÙ‚ Ø±Ù…Ø¶Ø§Ù† | Ø±Ø­Ù„Ø© Ø±ÙˆØ­Ø§Ù†ÙŠØ©</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+Arabic:wght@400;500;600;700&family=Reem+Kufi:wght@500;700&family=Alexandria:wght@400;500;700&family=Amiri:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    screens: { 'xs': '375px' },
                    colors: {
                        ramadan: { base: '#000000', surface: '#09090b', card: '#18181b', gold: '#fbbf24', teal: '#2dd4bf', rose: '#fb7185', accent: '#27272a' },
                        theme: { bg: '#1a0b33', surface: '#3b1f63', primary: '#d8b4fe', accent: '#f0abfc', gold: '#fcd34d', success: '#4ade80' }
                    },
                    fontFamily: {
                        sans: ['IBM Plex Sans Arabic', 'sans-serif'],
                        alexandria: ['Alexandria', 'sans-serif'],
                        kufi: ['Reem Kufi', 'sans-serif'],
                        amiri: ['Amiri', 'serif'],
                    },
                    animation: {
                        'swing-1': 'swing 4s ease-in-out infinite alternate',
                        'swing-2': 'swing 5s ease-in-out infinite alternate',
                        'float': 'float 6s ease-in-out infinite',
                        'fade-in': 'fadeIn 0.5s ease-out forwards',
                        'slide-up': 'slideUp 0.4s cubic-bezier(0.34,1.56,0.64,1) forwards',
                        'slow-glow': 'slowGlow 5s ease-in-out infinite',
                        'pulse-ring': 'pulseRing 1.5s ease-out forwards',
                        'pop': 'pop 0.35s cubic-bezier(0.34,1.56,0.64,1) forwards',
                    },
                    keyframes: {
                        swing: { '0%': { transform: 'rotate(-4deg)' }, '100%': { transform: 'rotate(4deg)' } },
                        float: { '0%, 100%': { transform: 'translateY(0)' }, '50%': { transform: 'translateY(-12px)' } },
                        fadeIn: { '0%': { opacity: '0', transform: 'translateY(8px)' }, '100%': { opacity: '1', transform: 'translateY(0)' } },
                        slideUp: { '0%': { opacity: '0', transform: 'translateY(20px)' }, '100%': { opacity: '1', transform: 'translateY(0)' } },
                        slowGlow: { '0%, 100%': { opacity: '0.4' }, '50%': { opacity: '0.8' } },
                        pulseRing: { '0%': { transform: 'scale(1)', opacity: '1' }, '100%': { transform: 'scale(1.8)', opacity: '0' } },
                        pop: { '0%': { transform: 'scale(0.85)' }, '60%': { transform: 'scale(1.08)' }, '100%': { transform: 'scale(1)' } }
                    }
                }
            }
        }
    </script>

    <style>
        * { -webkit-tap-highlight-color: transparent; }
        body { transition: background-color 0.8s ease; overscroll-behavior: none; }
        
        .theme-male { 
            background-color: #0f0a06; 
            background-image: radial-gradient(circle at top, rgba(251, 191, 36, 0.06) 0%, transparent 55%);
            font-family: 'IBM Plex Sans Arabic', sans-serif; 
        }
        .theme-female { 
            background-color: #150824; 
            background-image: radial-gradient(circle at top, rgba(240, 171, 252, 0.06) 0%, transparent 55%);
            font-family: 'Alexandria', sans-serif; 
        }
        
        /* Glass panels */
        .glass-panel { 
            background: rgba(20, 15, 10, 0.75); 
            backdrop-filter: blur(20px); 
            border: 1px solid rgba(251, 191, 36, 0.15); 
            box-shadow: 0 8px 32px rgba(0,0,0,0.5), inset 0 1px 0 rgba(255,255,255,0.05); 
        }
        .glass-card { 
            background: rgba(30, 10, 50, 0.65); 
            backdrop-filter: blur(20px); 
            border: 1px solid rgba(240, 171, 252, 0.15); 
            box-shadow: 0 8px 32px rgba(0,0,0,0.5), inset 0 1px 0 rgba(255,255,255,0.05); 
        }
        
        /* Prayer buttons â€” male */
        .btn-fard-done { 
            background: linear-gradient(135deg, #f59e0b, #d97706); 
            color: #000; 
            font-weight: 800;
            border: none; 
            box-shadow: 0 4px 16px rgba(245, 158, 11, 0.45); 
        }
        .btn-sunnah-done { 
            background: rgba(251, 191, 36, 0.18); 
            color: #fbbf24; 
            border: 1.5px solid #fbbf24; 
            font-weight: 700;
        }
        
        /* Prayer buttons â€” female */
        .btn-fard-done-f { 
            background: linear-gradient(135deg, #d946ef, #a21caf); 
            color: #fff; 
            font-weight: 800;
            border: none; 
            box-shadow: 0 4px 16px rgba(217, 70, 239, 0.4); 
        }
        .btn-sunnah-done-f { 
            background: rgba(240, 171, 252, 0.18); 
            color: #f0abfc; 
            border: 1.5px solid #f0abfc; 
            font-weight: 700;
        }
        
        /* Habit items */
        .habit-active-m { 
            background: linear-gradient(135deg, rgba(251,191,36,0.12), rgba(251,191,36,0.03)) !important; 
            border-color: rgba(251,191,36,0.55) !important; 
        }
        .habit-active-f { 
            background: linear-gradient(135deg, rgba(240,171,252,0.12), rgba(240,171,252,0.03)) !important; 
            border-color: rgba(240,171,252,0.55) !important; 
        }

        /* Night glow cards */
        .night-glow-card { 
            background: linear-gradient(160deg, rgba(35,25,12,0.95), rgba(10,5,0,1)); 
            border: 1px solid rgba(251,191,36,0.25); 
        }
        .night-glow-f-card { 
            background: linear-gradient(160deg, rgba(45,18,65,0.9), rgba(15,5,30,1)); 
            border: 1px solid rgba(240,171,252,0.25); 
        }
        
        /* Progress ring */
        .progress-ring circle { transition: stroke-dashoffset 2.5s cubic-bezier(0.4, 0, 0.2, 1); }
        
        /* Lanterns */
        .lantern-svg { 
            position: absolute; top: -5px; width: 45px; height: 100px; z-index: 40; 
            filter: drop-shadow(0 0 12px rgba(251, 191, 36, 0.5)); opacity: 0.85; 
        }

        /* Toast */
        #toast { 
            position: fixed; bottom: 100px; left: 50%; 
            transform: translateX(-50%) translateY(20px); 
            z-index: 10000; opacity: 0; 
            transition: all 0.45s cubic-bezier(0.34, 1.56, 0.64, 1); 
            pointer-events: none;
        }
        #toast.show { opacity: 1; transform: translateX(-50%) translateY(0); }

        /* Dhikr bar */
        .dhikr-float { 
            background: rgba(12, 8, 4, 0.88); 
            backdrop-filter: blur(18px);
            border: 1px solid rgba(251,191,36,0.25);
            box-shadow: 0 8px 24px rgba(0,0,0,0.6), inset 0 0 20px rgba(251,191,36,0.04);
        }
        .theme-female .dhikr-float {
            background: rgba(18, 8, 28, 0.88);
            border: 1px solid rgba(240,171,252,0.25);
            box-shadow: 0 8px 24px rgba(0,0,0,0.6), inset 0 0 20px rgba(240,171,252,0.04);
        }

        /* Dhikr text transition */
        #dhikrText { transition: opacity 0.3s ease; }
        
        /* Input style */
        input[type="number"]::-webkit-inner-spin-button, 
        input[type="number"]::-webkit-outer-spin-button { -webkit-appearance: none; margin: 0; }
        input[type="number"] { -moz-appearance: textfield; }

        /* Save indicator dot */
        .unsaved-dot {
            width: 8px; height: 8px;
            background: #f87171;
            border-radius: 50%;
            display: inline-block;
            margin-right: 6px;
            box-shadow: 0 0 8px rgba(248,113,113,0.8);
            animation: blink 1.5s ease-in-out infinite;
        }
        @keyframes blink { 0%,100% { opacity: 1; } 50% { opacity: 0.3; } }

        /* Sticky save bar */
        .sticky-save {
            position: fixed;
            bottom: 90px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 45;
            transition: all 0.4s cubic-bezier(0.34,1.56,0.64,1);
            opacity: 0;
            pointer-events: none;
            transform: translateX(-50%) translateY(20px);
        }
        .sticky-save.visible {
            opacity: 1;
            pointer-events: auto;
            transform: translateX(-50%) translateY(0);
        }

        /* Prayer row enhanced */
        .prayer-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 14px 16px;
            border-radius: 16px;
            border: 1px solid rgba(255,255,255,0.06);
            background: rgba(0,0,0,0.25);
            transition: all 0.3s ease;
        }
        .prayer-row.row-done-m {
            background: rgba(251,191,36,0.06);
            border-color: rgba(251,191,36,0.2);
        }
        .prayer-row.row-done-f {
            background: rgba(240,171,252,0.06);
            border-color: rgba(240,171,252,0.2);
        }

        /* Prayer button base */
        .prayer-btn {
            padding: 10px 20px;
            border-radius: 12px;
            font-size: 15px;
            font-weight: 700;
            min-width: 76px;
            text-align: center;
            transition: all 0.2s ease;
            cursor: pointer;
            user-select: none;
            border: 1.5px solid rgba(255,255,255,0.15);
            color: rgba(255,255,255,0.4);
            background: rgba(0,0,0,0.3);
        }
        .prayer-btn:active { transform: scale(0.93); }

        /* Confetti burst on habit toggle */
        @keyframes sparkle {
            0% { transform: scale(0) rotate(0deg); opacity: 1; }
            100% { transform: scale(1.5) rotate(180deg); opacity: 0; }
        }
        
        /* Scrollbar */
        ::-webkit-scrollbar { width: 3px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: rgba(251,191,36,0.2); border-radius: 10px; }

        /* â•â• RAMADAN NIGHT ATMOSPHERE â•â• */
        #starCanvas {
            position: fixed; top: 0; left: 0;
            width: 100%; height: 100%;
            z-index: 0; pointer-events: none;
        }
        .crescent-moon {
            position: fixed; top: 68px; left: 18px;
            z-index: 2; pointer-events: none;
            animation: moonFloat 8s ease-in-out infinite;
            filter: drop-shadow(0 0 18px rgba(251,191,36,0.6)) drop-shadow(0 0 50px rgba(251,191,36,0.2));
        }
        .theme-female .crescent-moon {
            filter: drop-shadow(0 0 18px rgba(240,171,252,0.5)) drop-shadow(0 0 40px rgba(240,171,252,0.15));
        }
        @keyframes moonFloat {
            0%,100% { transform: translateY(0) rotate(-5deg); }
            50% { transform: translateY(-10px) rotate(0deg); }
        }
        .kaaba-scene {
            position: fixed; bottom: 75px; left: 0; right: 0;
            z-index: 1; pointer-events: none; opacity: 0.08;
            transition: opacity 1s;
        }
        .theme-female .kaaba-scene { opacity: 0.055; }
        .bg-orb {
            position: fixed; border-radius: 50%;
            filter: blur(90px); pointer-events: none;
            z-index: 0; animation: orbPulse 12s ease-in-out infinite;
        }
        @keyframes orbPulse {
            0%,100% { opacity: 0.1; transform: scale(1); }
            50% { opacity: 0.2; transform: scale(1.12); }
        }
        .sparkle-star {
            position: fixed; pointer-events: none; z-index: 2;
            color: #fbbf24; font-size: 10px;
            animation: twinkle ease-in-out infinite;
        }
        .theme-female .sparkle-star { color: #f0abfc; }
        @keyframes twinkle {
            0%,100% { opacity: 0.08; transform: scale(0.7); }
            50% { opacity: 1; transform: scale(1.3); }
        }
        .shooting-star {
            position: fixed; pointer-events: none; z-index: 3;
            width: 1px; height: 1px;
            background: white; border-radius: 50%;
            opacity: 0;
            animation: shoot linear forwards;
        }
        @keyframes shoot {
            0%   { opacity: 0; }
            2%   { opacity: 1; }
            100% { opacity: 0; transform: translate(-280px, 160px) scaleX(80); }
        }
        /* app content above all bg layers */
        #app-container { position: relative; z-index: 10; }
    </style>
</head>
<body class="min-h-screen text-zinc-100 overflow-x-hidden">

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• NIGHT SKY CANVAS â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<canvas id="starCanvas"></canvas>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• BACKGROUND ORBS â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="bg-orb" style="width:300px;height:300px;top:-80px;right:-60px;background:rgba(251,191,36,0.15);animation-delay:0s;"></div>
<div class="bg-orb" style="width:200px;height:200px;top:40%;left:-80px;background:rgba(251,191,36,0.08);animation-delay:4s;"></div>
<div class="bg-orb theme-female-only" style="width:250px;height:250px;top:-60px;right:-40px;background:rgba(240,171,252,0.12);animation-delay:2s;"></div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• CRESCENT MOON â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="crescent-moon">
    <svg width="52" height="52" viewBox="0 0 52 52" fill="none">
        <path d="M38 26C38 33.732 31.732 40 24 40C19.5 40 15.5 37.8 13 34.4C14.5 34.8 16 35 17.6 35C26.4 35 33.6 27.8 33.6 19C33.6 15.2 32.3 11.7 30.1 9C34.8 11.7 38 18.5 38 26Z" fill="#fbbf24" opacity="0.9"/>
        <path d="M38 26C38 33.732 31.732 40 24 40C19.5 40 15.5 37.8 13 34.4C14.5 34.8 16 35 17.6 35C26.4 35 33.6 27.8 33.6 19C33.6 15.2 32.3 11.7 30.1 9C34.8 11.7 38 18.5 38 26Z" fill="url(#moonGrad)"/>
        <!-- stars near moon -->
        <circle cx="44" cy="10" r="1.5" fill="#fbbf24" opacity="0.8">
            <animate attributeName="opacity" values="0.3;1;0.3" dur="2.5s" repeatCount="indefinite"/>
        </circle>
        <circle cx="48" cy="18" r="1" fill="#fbbf24" opacity="0.6">
            <animate attributeName="opacity" values="0.6;1;0.6" dur="3.2s" repeatCount="indefinite"/>
        </circle>
        <circle cx="40" cy="5" r="0.8" fill="#fbbf24" opacity="0.7">
            <animate attributeName="opacity" values="0.2;0.9;0.2" dur="1.8s" repeatCount="indefinite"/>
        </circle>
        <defs>
            <radialGradient id="moonGrad" cx="50%" cy="50%" r="50%">
                <stop offset="0%" stop-color="#fde68a" stop-opacity="0.2"/>
                <stop offset="100%" stop-color="#fbbf24" stop-opacity="0"/>
            </radialGradient>
        </defs>
    </svg>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• SPARKLE STARS â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="sparkle-star" style="top:12%;left:15%;animation-duration:3.1s;font-size:8px;">âœ¦</div>
<div class="sparkle-star" style="top:18%;right:20%;animation-duration:2.4s;font-size:6px;animation-delay:1s;">âœ¦</div>
<div class="sparkle-star" style="top:8%;left:40%;animation-duration:4s;font-size:5px;animation-delay:0.5s;">â˜…</div>
<div class="sparkle-star" style="top:22%;left:60%;animation-duration:2.8s;font-size:7px;animation-delay:1.8s;">âœ¦</div>
<div class="sparkle-star" style="top:5%;right:35%;animation-duration:3.5s;font-size:9px;animation-delay:0.3s;">âœ§</div>
<div class="sparkle-star" style="top:15%;right:8%;animation-duration:2s;font-size:5px;animation-delay:2.2s;">âœ¦</div>
<div class="sparkle-star" style="top:30%;left:5%;animation-duration:4.5s;font-size:6px;animation-delay:0.8s;">â˜…</div>
<div class="sparkle-star" style="top:25%;right:45%;animation-duration:3.8s;font-size:4px;animation-delay:1.5s;">âœ¦</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• KAABA SILHOUETTE â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="kaaba-scene">
    <svg width="100%" viewBox="0 0 800 220" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMax meet">
        <!-- distant mountains / horizon -->
        <path d="M0 180 Q100 120 200 150 Q300 100 400 130 Q500 90 600 140 Q700 110 800 150 L800 220 L0 220 Z" fill="white" opacity="0.3"/>
        <!-- ground -->
        <rect x="0" y="200" width="800" height="20" fill="white" opacity="0.4"/>
        <!-- minarets far left -->
        <rect x="100" y="60" width="14" height="140" fill="white"/>
        <polygon points="107,40 100,65 114,65" fill="white"/>
        <rect x="104" y="38" width="6" height="8" fill="white"/>
        <!-- minaret left-center -->
        <rect x="240" y="80" width="12" height="120" fill="white"/>
        <polygon points="246,62 240,82 252,82" fill="white"/>
        <rect x="243" y="60" width="6" height="8" fill="white"/>
        <!-- minaret right-center -->
        <rect x="548" y="80" width="12" height="120" fill="white"/>
        <polygon points="554,62 548,82 560,82" fill="white"/>
        <rect x="551" y="60" width="6" height="8" fill="white"/>
        <!-- minaret far right -->
        <rect x="686" y="60" width="14" height="140" fill="white"/>
        <polygon points="693,40 686,65 700,65" fill="white"/>
        <rect x="690" y="38" width="6" height="8" fill="white"/>
        <!-- Kaaba cube -->
        <rect x="330" y="100" width="140" height="110" fill="white"/>
        <!-- Kaaba top band (kiswa detail) -->
        <rect x="330" y="100" width="140" height="18" fill="white" opacity="0.6"/>
        <!-- door detail -->
        <rect x="385" y="148" width="30" height="62" fill="white" opacity="0.4"/>
        <!-- arch over door -->
        <path d="M385 148 Q400 135 415 148" fill="none" stroke="white" stroke-width="2" opacity="0.5"/>
        <!-- Hajar al-Aswad hint -->
        <circle cx="335" cy="160" r="5" fill="white" opacity="0.3"/>
        <!-- mosque dome center -->
        <ellipse cx="400" cy="98" rx="30" ry="12" fill="white" opacity="0.5"/>
        <!-- mosque building base -->
        <rect x="170" y="155" width="460" height="55" fill="white" opacity="0.5"/>
        <!-- arched windows mosque -->
        <path d="M210 175 Q220 162 230 175 L230 205 L210 205 Z" fill="white" opacity="0.3"/>
        <path d="M260 175 Q270 162 280 175 L280 205 L260 205 Z" fill="white" opacity="0.3"/>
        <path d="M520 175 Q530 162 540 175 L540 205 L520 205 Z" fill="white" opacity="0.3"/>
        <path d="M570 175 Q580 162 590 175 L590 205 L570 205 Z" fill="white" opacity="0.3"/>
    </svg>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• GROUND MIST â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="fixed bottom-0 left-0 right-0 h-24 pointer-events-none z-[1]" style="background:linear-gradient(to top, rgba(0,0,0,0.5) 0%, transparent 100%);"></div>

<!-- ==================== ÙÙˆØ§Ù†ÙŠØ³ ==================== -->
<div class="fixed top-0 left-0 w-full h-32 pointer-events-none z-[65]">
    <div class="lantern-svg animate-swing-1" style="left: 7%;">
        <svg viewBox="0 0 50 100"><path d="M25 0 L25 25 M15 25 L35 25 L40 55 L25 75 L10 55 Z" fill="rgba(251,191,36,0.12)" stroke="#fbbf24" stroke-width="1.5"/><circle cx="25" cy="50" r="4" fill="#fbbf24" class="animate-pulse"/></svg>
    </div>
    <div class="lantern-svg animate-swing-2 hidden md:block" style="left: 34%;">
        <svg viewBox="0 0 50 100"><path d="M25 0 L25 40 M10 40 L40 40 L45 70 L25 90 L5 70 Z" fill="rgba(251,191,36,0.12)" stroke="#fbbf24" stroke-width="2"/><circle cx="25" cy="65" r="3" fill="#fbbf24" class="animate-pulse"/></svg>
    </div>
    <div class="lantern-svg animate-swing-1 hidden md:block" style="right: 34%;">
        <svg viewBox="0 0 50 100"><path d="M25 0 L25 40 M10 40 L40 40 L45 70 L25 90 L5 70 Z" fill="rgba(251,191,36,0.12)" stroke="#fbbf24" stroke-width="2"/><circle cx="25" cy="65" r="3" fill="#fbbf24" class="animate-pulse"/></svg>
    </div>
    <div class="lantern-svg animate-swing-2" style="right: 7%;">
        <svg viewBox="0 0 50 100"><path d="M25 0 L25 25 M15 25 L35 25 L40 55 L25 75 L10 55 Z" fill="rgba(251,191,36,0.12)" stroke="#fbbf24" stroke-width="2"/><circle cx="25" cy="50" r="4" fill="#fbbf24" class="animate-pulse"/></svg>
    </div>
</div>

<!-- ==================== Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ ==================== -->
<div id="loadingScreen" class="fixed inset-0 z-[200] bg-[#0a0604] flex flex-col items-center justify-center transition-opacity duration-700">
    <div class="w-16 h-16 border-4 border-zinc-900 border-t-amber-500 rounded-full animate-spin mb-6 shadow-[0_0_20px_rgba(251,191,36,0.3)]"></div>
    <p class="text-amber-500/80 text-lg font-amiri tracking-widest">Ø³ÙƒÙˆÙ†Ù Ø§Ù„Ø·Ø§Ø¹Ø©..</p>
</div>

<!-- ==================== Ø´Ø§Ø´Ø© Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯ ==================== -->
<div id="welcomeScreen" class="fixed inset-0 z-[100] flex-col items-center justify-center p-5 hidden overflow-y-auto"
     style="display:none; background: radial-gradient(ellipse at 50% 20%, rgba(251,191,36,0.12) 0%, #0a0604 60%);">

    <div class="relative z-10 w-full max-w-sm mx-auto text-center py-8">

        <!-- Logo -->
        <div class="relative inline-flex items-center justify-center mb-6">
            <div class="absolute w-36 h-36 bg-amber-400/15 blur-2xl rounded-full"></div>
            <div class="w-28 h-28 rounded-full bg-gradient-to-b from-[#2a1d08] to-[#0f0a04] border-2 border-amber-500/50 flex items-center justify-center shadow-[0_0_50px_rgba(251,191,36,0.3)] relative z-10 animate-float">
                <!-- Kaaba SVG -->
                <svg width="60" height="56" viewBox="0 0 60 56" fill="none">
                    <rect x="8" y="18" width="44" height="34" rx="1" fill="#fbbf24" opacity="0.9"/>
                    <rect x="8" y="18" width="44" height="8" fill="#f59e0b" opacity="0.7"/>
                    <rect x="8" y="22" width="44" height="2" fill="#fde68a" opacity="0.5"/>
                    <rect x="23" y="36" width="14" height="16" rx="1" fill="#92400e" opacity="0.8"/>
                    <polygon points="8,18 30,4 52,18" fill="#d97706" opacity="0.95"/>
                    <rect x="27" y="0" width="6" height="6" rx="1" fill="#fbbf24"/>
                </svg>
            </div>
        </div>

        <!-- Title -->
        <h1 class="text-5xl font-amiri font-bold text-white mb-2 leading-tight">Ø±ÙÙŠÙ‚Ù Ø±Ù…Ø¶Ø§Ù†</h1>
        <p class="text-amber-400/70 text-sm font-kufi mb-8 tracking-wide">Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø±Ø­Ù„ØªÙƒ Ø§Ù„Ø±ÙˆØ­Ø§Ù†ÙŠØ© Â· Ù¡Ù¤Ù¤Ù¦Ù‡Ù€</p>

        <!-- Card -->
        <div class="bg-[#110d06]/90 backdrop-blur-xl border border-amber-500/20 rounded-[2rem] p-6 space-y-6 shadow-[0_20px_60px_rgba(0,0,0,0.7)]">

            <!-- Name input -->
            <div class="space-y-2 text-right">
                <label class="text-xs text-amber-500/80 font-bold font-kufi tracking-wider">Ø§Ø³Ù…ÙÙƒ Ø§Ù„ÙƒØ±ÙŠÙ…</label>
                <div class="relative">
                    <input type="text" id="setupName" placeholder="ÙƒÙŠÙ Ù†ÙÙ†Ø§Ø¯ÙŠÙƒØŸ"
                        class="w-full bg-[#0a0604] border border-amber-500/25 rounded-2xl px-5 py-4 text-white text-center focus:outline-none focus:border-amber-400 focus:ring-2 focus:ring-amber-400/20 transition-all font-bold text-xl font-amiri placeholder-zinc-700"
                        onkeydown="if(event.key==='Enter') window.finishSetup()">
                    <div class="absolute left-4 top-1/2 -translate-y-1/2 w-2 h-2 bg-amber-500 rounded-full opacity-50 animate-pulse"></div>
                </div>
            </div>

            <!-- Theme selector -->
            <div class="space-y-3 text-right">
                <label class="text-xs text-amber-500/80 font-bold font-kufi tracking-wider">Ø§Ø®ØªÙØ± ÙˆØ§Ø¬Ù‡ØªÙƒ</label>
                <div class="grid grid-cols-2 gap-3">

                    <!-- Male -->
                    <div onclick="window.selectSetupTheme('male')" id="themeMale"
                        class="setup-theme-card cursor-pointer rounded-2xl p-4 flex flex-col items-center gap-3 border-2 border-amber-500/40 bg-gradient-to-b from-[#1a120b] to-[#0a0604] transition-all active:scale-95 selected-male">
                        <div class="w-14 h-14 rounded-2xl bg-amber-500/15 flex items-center justify-center border border-amber-500/30">
                            <!-- Man icon SVG -->
                            <svg width="30" height="30" viewBox="0 0 30 30" fill="none">
                                <circle cx="15" cy="8" r="5" fill="#fbbf24" opacity="0.9"/>
                                <path d="M6 26c0-5 4-9 9-9s9 4 9 9" stroke="#fbbf24" stroke-width="2.5" stroke-linecap="round" fill="none" opacity="0.9"/>
                                <rect x="11" y="16" width="8" height="6" rx="2" fill="#fbbf24" opacity="0.7"/>
                            </svg>
                        </div>
                        <div>
                            <span class="text-base font-bold font-kufi text-white block">Ø±Ø¬Ø§Ù„ÙŠ</span>
                            <span class="text-xs text-amber-400/50 font-amiri">Ø°Ù‡Ø¨ÙŠ</span>
                        </div>
                    </div>

                    <!-- Female -->
                    <div onclick="window.selectSetupTheme('female')" id="themeFemale"
                        class="setup-theme-card cursor-pointer rounded-2xl p-4 flex flex-col items-center gap-3 border-2 border-fuchsia-500/25 bg-gradient-to-b from-[#150824] to-[#0a0604] transition-all active:scale-95">
                        <div class="w-14 h-14 rounded-2xl bg-fuchsia-500/15 flex items-center justify-center border border-fuchsia-500/30">
                            <!-- Hijabi woman SVG -->
                            <svg width="30" height="30" viewBox="0 0 30 30" fill="none">
                                <circle cx="15" cy="8" r="4.5" fill="#f0abfc" opacity="0.9"/>
                                <!-- hijab shape -->
                                <path d="M8 14 Q8 8 15 7 Q22 8 22 14 Q22 18 15 19 Q8 18 8 14Z" fill="#d946ef" opacity="0.7"/>
                                <path d="M7 26c0-5 4-8 8-8s8 3 8 8" stroke="#f0abfc" stroke-width="2.5" stroke-linecap="round" fill="none" opacity="0.9"/>
                            </svg>
                        </div>
                        <div>
                            <span class="text-base font-bold font-kufi text-white block">Ø¨Ù†Ø§ØªÙŠ</span>
                            <span class="text-xs text-fuchsia-400/50 font-amiri">ÙˆØ±Ø¯ÙŠ</span>
                        </div>
                    </div>

                </div>
            </div>

            <!-- Start button -->
            <button onclick="window.finishSetup()"
                class="w-full bg-gradient-to-r from-amber-500 to-amber-600 hover:from-amber-400 hover:to-amber-500 text-black font-extrabold font-kufi py-4 rounded-2xl shadow-[0_0_25px_rgba(251,191,36,0.45)] transition-all active:scale-95 text-xl border-b-4 border-amber-700 mt-2">
                Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø±Ø­Ù„Ø©Ù Ø§Ù„Ù…Ø¨Ø§Ø±ÙƒØ© âœ¨
            </button>

        </div>

        <!-- Bottom note -->
        <p class="text-white/20 text-xs font-amiri mt-6">Ø±ÙÙ…ÙØ¶ÙØ§Ù†Ù Ø´ÙÙ‡Ù’Ø±Ù Ø§Ù„Ù’Ù‚ÙØ±Ù’Ø¢Ù†</p>
    </div>
</div>

<style>
    .selected-male  { border-color: rgba(251,191,36,0.8) !important; box-shadow: 0 0 20px rgba(251,191,36,0.2); }
    .selected-female{ border-color: rgba(217,70,239,0.8) !important; box-shadow: 0 0 20px rgba(217,70,239,0.2); }
</style>

<!-- ==================== Ø´Ø±ÙŠØ· Ø§Ù„Ø£Ø°ÙƒØ§Ø± ==================== -->
<div class="fixed z-[70] pointer-events-none" style="top: 10px; left: 60px; right: 60px;">
    <div id="dhikrOverlay" class="dhikr-float mx-auto max-w-md rounded-2xl px-4 py-3 flex items-center justify-between relative overflow-hidden">
        <div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/4 to-transparent animate-slow-glow"></div>
        <i class="fas fa-star-and-crescent text-amber-400/70 text-lg animate-pulse relative z-10 flex-shrink-0"></i>
        <div class="flex flex-col flex-grow px-3 relative z-10 text-center">
            <span id="dhikrText" class="text-xl font-bold font-amiri text-white leading-relaxed">Ù„ÙØ§ Ø¥ÙÙ„ÙÙ‡Ù Ø¥ÙÙ„ÙÙ‘Ø§ Ø§Ù„Ù„ÙÙ‘Ù‡</span>
        </div>
        <i class="fas fa-star text-amber-400/70 text-base animate-pulse relative z-10 flex-shrink-0"></i>
    </div>
</div>

<!-- ==================== Toast ==================== -->
<div id="toast" class="bg-[#1a120b]/95 backdrop-blur-xl text-amber-400 px-8 py-4 rounded-2xl shadow-[0_10px_30px_rgba(0,0,0,0.8)] border border-amber-500/30 font-bold text-lg font-kufi text-center whitespace-nowrap"></div>

<!-- ==================== Sticky Save Button ==================== -->
<div id="stickySave" class="sticky-save">
    <button onclick="window.saveData()" class="flex items-center gap-2 px-8 py-3 rounded-2xl font-bold font-kufi text-lg shadow-2xl backdrop-blur-xl transition-all active:scale-95" id="stickySaveBtn">
        <span class="unsaved-dot"></span>
        <span>Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª</span>
    </button>
</div>

<!-- ==================== App Container ==================== -->
<div id="app-container" class="hidden opacity-0 transition-opacity duration-700 min-h-screen" style="padding-top: 80px;"></div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
    import { getFirestore, doc, getDoc, setDoc, updateDoc } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

    const firebaseConfig = {
        apiKey: "AIzaSyBtHvklnxlP7ZgTvwJrpgMz4cbWiuhq9TM",
        authDomain: "create-project-36d4c.firebaseapp.com",
        projectId: "create-project-36d4c",
        storageBucket: "create-project-36d4c.firebasestorage.app",
        messagingSenderId: "384696044918",
        appId: "1:384696044918:web:f78daf55009be623b1fe57"
    };
    const fbApp = initializeApp(firebaseConfig);
    const db = getFirestore(fbApp);

    const PRAYERS_CONFIG = {
        fajr:   { label: 'Ø§Ù„ÙØ¬Ø±',   fard: true,  sunnah: true  },
        duha:   { label: 'Ø§Ù„Ø¶Ø­Ù‰',   fard: false, sunnah: true  },
        dhuhr:  { label: 'Ø§Ù„Ø¸Ù‡Ø±',   fard: true,  sunnah: true  },
        asr:    { label: 'Ø§Ù„Ø¹ØµØ±',   fard: true,  sunnah: true  },
        maghrib:{ label: 'Ø§Ù„Ù…ØºØ±Ø¨',  fard: true,  sunnah: true  },
        isha:   { label: 'Ø§Ù„Ø¹Ø´Ø§Ø¡',  fard: true,  sunnah: true  }
    };

    const PRAYER_ICONS = {
        fajr: 'fa-moon', duha: 'fa-sun', dhuhr: 'fa-circle-dot',
        asr: 'fa-sun', maghrib: 'fa-cloud', isha: 'fa-star-and-crescent'
    };

    const DHIKR_LIST = [
        "ØµÙÙ„ÙÙ‘ Ø¹ÙÙ„ÙÙ‰ Ù…ÙØ­ÙÙ…ÙÙ‘Ø¯Ù ï·º",
        "Ù„ÙØ§ Ø¥ÙÙ„ÙÙ‡Ù Ø¥ÙÙ„ÙÙ‘Ø§ Ø§Ù„Ù„ÙÙ‘Ù‡",
        "Ø³ÙØ¨Ù’Ø­ÙØ§Ù†Ù Ø§Ù„Ù„ÙÙ‘Ù‡Ù ÙˆÙØ¨ÙØ­ÙÙ…Ù’Ø¯ÙÙ‡Ù",
        "Ø£ÙØ³Ù’ØªÙØºÙ’ÙÙØ±Ù Ø§Ù„Ù„ÙÙ‘Ù‡Ù Ø§Ù„Ù’Ø¹ÙØ¸ÙÙŠÙ…",
        "Ù„ÙØ§ Ø­ÙÙˆÙ’Ù„Ù ÙˆÙÙ„ÙØ§ Ù‚ÙÙˆÙÙ‘Ø©Ù Ø¥ÙÙ„ÙÙ‘Ø§ Ø¨ÙØ§Ù„Ù„ÙÙ‘Ù‡",
        "Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ Ø¥ÙÙ†ÙÙ‘ÙƒÙ Ø¹ÙÙÙÙˆÙŒÙ‘ ØªÙØ­ÙØ¨ÙÙ‘ Ø§Ù„Ù’Ø¹ÙÙÙ’ÙˆÙ ÙÙØ§Ø¹Ù’ÙÙ Ø¹ÙÙ†ÙÙ‘Ø§",
        "Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ Ø¨ÙÙ„ÙÙ‘ØºÙ’Ù†ÙØ§ Ù„ÙÙŠÙ’Ù„ÙØ©Ù Ø§Ù„Ù’Ù‚ÙØ¯Ù’Ø±"
    ];

    const FOOTER_HTML = `
    <div class="mt-16 pb-10 pt-8 border-t border-white/8">
        <div class="text-center">
            <div class="text-xs tracking-[0.25em] uppercase text-white/25 font-sans">Devoted By Eng. Mahmoud Attia</div>
        </div>
    </div>`;

    let currentUser = localStorage.getItem('ramadanUserName');
    let currentTheme = localStorage.getItem('ramadanUserTheme') || 'male';
    let currentDate = new Date().toISOString().split('T')[0];
    let appData = {};
    let dhikrIndex = 0;
    let hasUnsavedChanges = false;

    /* â”€â”€ Dhikr rotation â”€â”€ */
    setInterval(() => {
        const el = document.getElementById('dhikrText');
        if (el) {
            el.style.opacity = 0;
            setTimeout(() => {
                dhikrIndex = (dhikrIndex + 1) % DHIKR_LIST.length;
                el.textContent = DHIKR_LIST[dhikrIndex];
                el.style.opacity = 1;
            }, 300);
        }
    }, 6000);

    /* â”€â”€ Toast â”€â”€ */
    function showToast(msg) {
        const t = document.getElementById('toast');
        t.textContent = msg;
        t.classList.add('show');
        setTimeout(() => t.classList.remove('show'), 3200);
    }

    /* â”€â”€ Unsaved indicator â”€â”€ */
    function markUnsaved() {
        hasUnsavedChanges = true;
        const ss = document.getElementById('stickySave');
        if (ss) ss.classList.add('visible');
        // Style the sticky save button per theme
        const btn = document.getElementById('stickySaveBtn');
        if (btn) {
            if (currentTheme === 'male') {
                btn.style.background = 'linear-gradient(135deg, #f59e0b, #d97706)';
                btn.style.color = '#000';
                btn.style.border = 'none';
            } else {
                btn.style.background = 'linear-gradient(135deg, #d946ef, #7c3aed)';
                btn.style.color = '#fff';
                btn.style.border = 'none';
            }
        }
    }
    function markSaved() {
        hasUnsavedChanges = false;
        const ss = document.getElementById('stickySave');
        if (ss) ss.classList.remove('visible');
    }

    /* â”€â”€ Firebase â”€â”€ */
    async function fetchData() {
        try {
            const docRef = doc(db, "users", currentUser);
            const docSnap = await getDoc(docRef);
            if (docSnap.exists()) appData = docSnap.data().appData || {};
            loadApp();
        } catch {
            appData = JSON.parse(localStorage.getItem('ramadanTrackerData_v5') || '{}');
            loadApp();
        }
    }

    /* â”€â”€ Templates â”€â”€ */
    function getMaleTemplate() {
        return `
        <!-- Bottom Nav -->
        <header class="fixed bottom-0 left-0 right-0 z-50 bg-[#0f0a06]/96 backdrop-blur-2xl border-t border-amber-500/15 pb-safe shadow-[0_-8px_24px_rgba(0,0,0,0.7)]">
            <nav class="flex justify-around items-center max-w-md mx-auto font-kufi text-sm font-bold px-2 py-3">
                <button onclick="window.toggleView('dashboard')" id="nav-dashboard" class="nav-item active flex flex-col items-center gap-1 text-amber-500 transition-all min-w-[56px]">
                    <i class="fas fa-home text-xl"></i><span class="text-xs">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span>
                </button>
                <button onclick="window.toggleView('quran')" id="nav-quran" class="nav-item flex flex-col items-center gap-1 text-white/50 hover:text-white transition-all min-w-[56px]">
                    <i class="fas fa-book-quran text-xl"></i><span class="text-xs">Ø§Ù„Ù‚Ø±Ø¢Ù†</span>
                </button>
                <div class="flex flex-col items-center gap-1 text-white/60 px-1">
                    <div class="flex items-center gap-1">
                        <i class="fas fa-fire text-amber-500 text-base"></i>
                        <span class="font-bold text-white font-amiri text-lg" id="streakCount">0</span>
                    </div>
                    <span class="text-[10px] text-white/30">ÙŠÙˆÙ…</span>
                </div>
                <button onclick="window.toggleView('duaa')" id="nav-duaa" class="nav-item flex flex-col items-center gap-1 text-white/50 hover:text-white transition-all min-w-[56px]">
                    <i class="fas fa-hands-praying text-xl"></i><span class="text-xs">Ø§Ù„Ø¯Ø¹Ø§Ø¡</span>
                </button>
            </nav>
        </header>

        <div id="dashboard-view" class="animate-fade-in px-4 max-w-lg mx-auto space-y-6 pb-36">
            
            <!-- Header -->
            <div class="text-center space-y-2 pt-2">
                <h2 class="text-3xl font-bold font-kufi text-white">Ù…Ø±Ø­Ø¨Ø§Ù‹ ${currentUser} ğŸŒ™</h2>
                <p class="text-amber-400/70 font-amiri text-base">ØªÙ‚Ø¨Ù„ Ø§Ù„Ù„Ù‡ Ø·Ø§Ø¹ØªÙƒ ÙˆØµÙŠØ§Ù…Ùƒ</p>
            </div>

            <!-- Date Navigator -->
            <div class="flex items-center justify-between bg-[#1a120b]/80 border border-amber-500/20 rounded-2xl p-2 shadow-lg backdrop-blur-sm">
                <button onclick="window.changeDate(1)" class="w-11 h-11 flex items-center justify-center rounded-xl bg-[#2a1d13] text-amber-400 active:bg-[#3a2a1a] transition-all active:scale-90">
                    <i class="fas fa-chevron-right text-sm"></i>
                </button>
                <div class="text-center">
                    <span id="dateDisplay" class="font-bold text-base font-kufi text-white block">...</span>
                    <span id="dateTag" class="text-xs text-amber-500/60 font-amiri">Ø§Ù„ÙŠÙˆÙ…</span>
                </div>
                <button onclick="window.changeDate(-1)" class="w-11 h-11 flex items-center justify-center rounded-xl bg-[#2a1d13] text-amber-400 active:bg-[#3a2a1a] transition-all active:scale-90">
                    <i class="fas fa-chevron-left text-sm"></i>
                </button>
            </div>

            <!-- Prayers -->
            <div class="glass-panel rounded-3xl p-5 space-y-5">
                <div class="flex items-center gap-3 pb-3 border-b border-amber-500/15">
                    <i class="fas fa-mosque text-xl text-amber-400"></i>
                    <h3 class="font-bold text-xl font-kufi text-white">Ø§Ù„ØµÙ„ÙˆØ§Øª</h3>
                    <span id="prayerProgress" class="mr-auto text-xs font-bold text-amber-400/70 bg-amber-500/10 px-3 py-1 rounded-lg font-kufi">0/5 ÙØ±ÙˆØ¶</span>
                </div>
                <div id="prayersList" class="space-y-3"></div>
            </div>

            <!-- Habits -->
            <div class="glass-panel rounded-3xl p-5 space-y-5">
                <div class="flex items-center gap-3 pb-3 border-b border-amber-500/15">
                    <i class="fas fa-gem text-xl text-amber-400"></i>
                    <h3 class="font-bold text-xl font-kufi text-white">Ø£Ø°ÙƒØ§Ø±Ùƒ ÙˆÙˆÙØ±Ø¯Ùƒ</h3>
                </div>
                <div class="space-y-3">
                    <div id="m_morning" onclick="window.toggleHabit('m_morning')" class="prayer-row cursor-pointer select-none" role="button" aria-pressed="false">
                        <div class="flex items-center gap-3">
                            <div class="w-10 h-10 rounded-xl bg-amber-500/10 flex items-center justify-center flex-shrink-0">
                                <i class="fas fa-cloud-sun text-amber-400"></i>
                            </div>
                            <span class="text-lg font-amiri font-bold text-white">Ø£Ø°ÙƒØ§Ø± Ø§Ù„ØµØ¨Ø§Ø­</span>
                        </div>
                        <div class="check-circle w-9 h-9 rounded-full border-2 border-white/20 flex items-center justify-center transition-all flex-shrink-0">
                            <i class="fas fa-check text-sm opacity-0 text-black"></i>
                        </div>
                    </div>
                    <div id="m_evening" onclick="window.toggleHabit('m_evening')" class="prayer-row cursor-pointer select-none" role="button">
                        <div class="flex items-center gap-3">
                            <div class="w-10 h-10 rounded-xl bg-amber-500/10 flex items-center justify-center flex-shrink-0">
                                <i class="fas fa-moon text-amber-400"></i>
                            </div>
                            <span class="text-lg font-amiri font-bold text-white">Ø£Ø°ÙƒØ§Ø± Ø§Ù„Ù…Ø³Ø§Ø¡</span>
                        </div>
                        <div class="check-circle w-9 h-9 rounded-full border-2 border-white/20 flex items-center justify-center transition-all flex-shrink-0">
                            <i class="fas fa-check text-sm opacity-0 text-black"></i>
                        </div>
                    </div>
                    <div id="m_taraweeh" onclick="window.toggleHabit('m_taraweeh')" class="night-glow-card p-4 rounded-2xl flex items-center justify-between cursor-pointer transition-all select-none" role="button">
                        <div class="flex items-center gap-4">
                            <div class="w-12 h-12 rounded-full bg-amber-500/15 flex items-center justify-center flex-shrink-0">
                                <i class="fas fa-star-and-crescent text-amber-400 text-lg"></i>
                            </div>
                            <div>
                                <span class="text-xl font-bold font-kufi block text-white">Ù‚ÙŠØ§Ù… Ø§Ù„Ù„ÙŠÙ„</span>
                                <span class="text-xs text-amber-400/50 font-amiri">ØµÙ„Ø§Ø© Ø§Ù„ØªØ±Ø§ÙˆÙŠØ­</span>
                            </div>
                        </div>
                        <div class="check-circle w-10 h-10 rounded-full border-2 border-amber-400/25 flex items-center justify-center transition-all flex-shrink-0">
                            <i class="fas fa-check text-lg opacity-0 text-black"></i>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quran + Work inputs -->
            <div class="glass-panel rounded-3xl p-5 space-y-4">
                <div class="flex items-center gap-3 pb-3 border-b border-amber-500/15">
                    <i class="fas fa-book-open text-xl text-amber-400"></i>
                    <h3 class="font-bold text-xl font-kufi text-white">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ÙŠÙˆÙ…</h3>
                </div>
                <div class="grid grid-cols-2 gap-3">
                    <div class="bg-[#1a120b] p-4 rounded-2xl border border-amber-500/10 text-center">
                        <div class="text-xs font-bold text-amber-400/70 mb-2 font-kufi">ØµÙØ­Ø§Øª Ø§Ù„Ù‚Ø±Ø¢Ù†</div>
                        <input type="number" id="quranInput" placeholder="0" inputmode="numeric" 
                            class="w-full bg-transparent text-white text-4xl font-bold text-center focus:outline-none placeholder-zinc-800 font-amiri"
                            onchange="window.onInputChange()" oninput="window.onInputChange()">
                        <div class="text-xs text-white/20 mt-1 font-amiri">ØµÙØ­Ø©</div>
                    </div>
                    <div class="bg-[#1a120b] p-4 rounded-2xl border border-amber-500/10 text-center">
                        <div class="text-xs font-bold text-amber-400/70 mb-2 font-kufi">Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø¹Ù…Ù„</div>
                        <input type="number" id="workInput" placeholder="0" inputmode="decimal"
                            class="w-full bg-transparent text-white text-4xl font-bold text-center focus:outline-none placeholder-zinc-800 font-amiri"
                            onchange="window.onInputChange()" oninput="window.onInputChange()">
                        <div class="text-xs text-white/20 mt-1 font-amiri">Ø³Ø§Ø¹Ø©</div>
                    </div>
                </div>
            </div>

            <!-- Daily Analytics (Ring) -->
            <div class="glass-panel rounded-3xl p-6 space-y-8 relative overflow-hidden">
                <div class="text-center relative z-10">
                    <h3 class="text-2xl font-bold font-kufi text-white">Ø¥Ø´Ø±Ø§Ù‚Ø§Øª Ø§Ù„ÙŠÙˆÙ…</h3>
                    <div class="h-0.5 w-12 bg-amber-500/40 mx-auto rounded-full mt-2"></div>
                </div>

                <div class="relative w-56 h-56 mx-auto">
                    <div class="absolute inset-0 bg-amber-500/8 blur-[35px] rounded-full animate-slow-glow"></div>
                    <svg class="w-full h-full -rotate-90 relative z-10" viewBox="0 0 256 256">
                        <circle cx="128" cy="128" r="110" stroke="rgba(255,255,255,0.05)" stroke-width="10" fill="none"/>
                        <circle id="performanceRing" cx="128" cy="128" r="110" stroke="#fbbf24" stroke-width="14" fill="none" stroke-dasharray="691" stroke-dashoffset="691" stroke-linecap="round"/>
                    </svg>
                    <div class="absolute inset-0 flex flex-col items-center justify-center text-center z-20">
                        <span id="performancePct" class="text-5xl font-bold text-white font-kufi">0%</span>
                        <span id="performanceLabel" class="text-sm font-amiri text-amber-400 mt-1">Ø³Ø¹ÙŠÙŒ Ø·ÙŠØ¨</span>
                    </div>
                </div>

                <!-- Khatma progress -->
                <div class="bg-[#1a120b] p-5 rounded-2xl border border-amber-500/10">
                    <div class="flex justify-between items-center mb-3">
                        <span class="text-sm font-bold text-white/60 font-kufi">Ù…Ø³Ø§Ø± Ø®ØªÙ…Ø© Ø§Ù„Ù‚Ø±Ø¢Ù†</span>
                        <span id="khatmaLabel" class="text-xs font-bold text-amber-400 bg-amber-500/10 px-3 py-1 rounded-lg font-kufi">Ø§Ù„Ø¬Ø²Ø¡ 1</span>
                    </div>
                    <div class="relative h-2.5 bg-black rounded-full overflow-hidden border border-white/5 mb-3">
                        <div id="khatmaBar" class="absolute top-0 right-0 h-full bg-amber-400 rounded-full shadow-[0_0_12px_rgba(251,191,36,0.6)] transition-all duration-1000" style="width:0%"></div>
                    </div>
                    <div class="flex justify-between text-center">
                        <div>
                            <div class="text-xs text-amber-400/50 font-kufi">Ù‚ÙØ±Ø¦Øª</div>
                            <div id="currentPages" class="text-2xl font-bold text-white font-amiri">0</div>
                        </div>
                        <div>
                            <div class="text-xs text-white/30 font-kufi">Ù…ØªØ¨Ù‚ÙŠ</div>
                            <div id="remainingPages" class="text-2xl font-bold text-white/40 font-amiri">604</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Month Harvest -->
            <div class="glass-panel rounded-3xl p-5 space-y-4">
                <div class="flex items-center gap-3 pb-3 border-b border-amber-500/15">
                    <i class="fas fa-chart-bar text-xl text-amber-400"></i>
                    <h3 class="font-bold text-xl font-kufi text-white">Ø­ØµØ§Ø¯ Ø§Ù„Ø´Ù‡Ø± Ø§Ù„Ù…Ø¨Ø§Ø±Ùƒ</h3>
                </div>
                <div class="grid grid-cols-2 gap-3">
                    <div class="bg-[#1a120b] p-4 rounded-2xl border border-amber-500/10 text-center">
                        <div class="text-3xl font-bold text-white font-amiri" id="monthFard">0</div>
                        <div class="text-xs text-amber-400/70 mt-1 font-kufi">ÙØ±ÙˆØ¶ Ù…Ø¤Ø¯Ø§Ø©</div>
                    </div>
                    <div class="bg-[#1a120b] p-4 rounded-2xl border border-amber-500/10 text-center">
                        <div class="text-3xl font-bold text-white font-amiri" id="monthSunnah">0</div>
                        <div class="text-xs text-amber-400/70 mt-1 font-kufi">Ø³Ù†Ù† ÙˆÙ†ÙˆØ§ÙÙ„</div>
                    </div>
                    <div class="bg-[#1a120b] p-4 rounded-2xl border border-amber-500/10 text-center">
                        <div class="text-3xl font-bold text-white font-amiri" id="monthTaraweeh">0</div>
                        <div class="text-xs text-amber-400/70 mt-1 font-kufi">Ø£ÙŠØ§Ù… Ø§Ù„ØªØ±Ø§ÙˆÙŠØ­</div>
                    </div>
                    <div class="bg-gradient-to-br from-amber-500/15 to-transparent p-4 rounded-2xl border border-amber-500/25 text-center">
                        <div class="text-3xl font-bold text-amber-400 font-amiri" id="monthScore">0%</div>
                        <div class="text-xs text-amber-400 mt-1 font-kufi font-bold">Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø§Ù„Ø¹Ø§Ù…</div>
                    </div>
                </div>
            </div>

            <!-- Save button -->
            <button onclick="window.saveData()" id="saveBtn" class="w-full bg-amber-500 hover:bg-amber-400 active:bg-amber-600 text-black font-extrabold font-kufi py-5 rounded-2xl text-xl shadow-[0_5px_20px_rgba(251,191,36,0.35)] transition-all active:scale-95 border-b-4 border-amber-700">
                ğŸ’¾ Ø­ÙØ¸ ÙŠÙˆÙ…ÙŠØ§ØªÙŠ
            </button>

            <div class="flex justify-center gap-8 py-2">
                <button onclick="window.goHome()" class="text-sm text-white/40 hover:text-white transition-all font-kufi">ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ</button>
                <button onclick="window.resetData()" class="text-sm text-red-500/50 hover:text-red-400 transition-all font-kufi">ØªØµÙÙŠØ± Ø§Ù„Ø³Ø¬Ù„</button>
            </div>
            
            ${FOOTER_HTML}
        </div>

        <!-- Quran View (male) -->
        <div id="quran-view" class="hidden animate-fade-in pb-32 px-4 max-w-lg mx-auto space-y-4">

            <div class="text-center mt-4 mb-2 relative">
                <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-32 h-32 bg-amber-500/8 blur-3xl rounded-full"></div>
                <i class="fas fa-book-quran text-5xl text-amber-400 drop-shadow-[0_0_25px_rgba(251,191,36,0.5)] mb-3 block animate-float relative z-10"></i>
                <h2 class="text-3xl font-amiri font-bold text-white relative z-10">Ø§Ù„Ù‚ÙØ±Ù’Ø¢Ù†Ù Ø§Ù„ÙƒÙØ±ÙÙŠÙ…</h2>
                <div class="h-0.5 w-16 bg-gradient-to-r from-transparent via-amber-500 to-transparent mx-auto rounded-full mt-2"></div>
            </div>

            <!-- Surah selector -->
            <div class="glass-panel rounded-3xl p-4 space-y-3">
                <div class="flex gap-2">
                    <select id="surahSelect" onchange="window.loadSurah()"
                        class="flex-1 bg-black/50 border border-amber-500/25 rounded-2xl px-4 py-3 text-white font-amiri text-base focus:outline-none focus:border-amber-400 transition-all appearance-none text-right cursor-pointer">
                        <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø³ÙˆØ±Ø©...</option>
                    </select>
                    <div class="flex gap-2">
                        <button onclick="window.changeFontSize(-1)" class="w-11 h-11 rounded-xl bg-black/40 border border-amber-500/20 text-amber-400 font-bold text-lg active:scale-90 transition-all">Ù€</button>
                        <button onclick="window.changeFontSize(1)"  class="w-11 h-11 rounded-xl bg-black/40 border border-amber-500/20 text-amber-400 font-bold text-lg active:scale-90 transition-all">+</button>
                    </div>
                </div>
                <!-- Surah info bar -->
                <div id="surahInfo" class="hidden flex items-center justify-between text-xs font-kufi px-1">
                    <span id="surahNameAr" class="text-amber-400 font-bold text-sm font-amiri"></span>
                    <span id="surahVerseCount" class="text-white/40"></span>
                </div>
            </div>

            <!-- Quran text display -->
            <div id="quranLoading" class="hidden text-center py-12">
                <div class="w-10 h-10 border-3 border-amber-500/30 border-t-amber-400 rounded-full animate-spin mx-auto mb-3"></div>
                <p class="text-amber-400/60 font-amiri text-lg">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³ÙˆØ±Ø©...</p>
            </div>

            <div id="quranContainer" class="glass-panel rounded-3xl p-5 hidden">
                <!-- Bismillah -->
                <div id="bismillah" class="text-center mb-6 py-4 border-b border-amber-500/15">
                    <p class="font-amiri text-3xl text-amber-300 leading-loose">Ø¨ÙØ³Ù’Ù…Ù Ø§Ù„Ù„ÙÙ‘Ù‡Ù Ø§Ù„Ø±ÙÙ‘Ø­Ù’Ù…ÙÙ°Ù†Ù Ø§Ù„Ø±ÙÙ‘Ø­ÙÙŠÙ…Ù</p>
                </div>
                <!-- Verses -->
                <div id="quranVerses" class="space-y-5 text-right leading-[2.8]" style="font-size: 26px;"></div>
            </div>

            <!-- Page progress -->
            <div id="quranNavBar" class="hidden glass-panel rounded-2xl p-3 flex items-center justify-between gap-2">
                <button onclick="window.prevSurah()" class="flex-shrink-0 w-10 h-10 rounded-xl bg-amber-500/15 text-amber-400 active:scale-90 transition-all text-sm font-bold">
                    <i class="fas fa-chevron-right"></i>
                </button>
                <span id="quranNavLabel" class="text-xs text-white/50 font-kufi text-center flex-1">Ø§Ù„Ø³ÙˆØ±Ø©</span>
                <button onclick="window.nextSurah()" class="flex-shrink-0 w-10 h-10 rounded-xl bg-amber-500/15 text-amber-400 active:scale-90 transition-all text-sm font-bold">
                    <i class="fas fa-chevron-left"></i>
                </button>
            </div>
        </div>

        <!-- Duaa View -->
        <div id="duaa-view" class="hidden animate-fade-in pb-32 px-4 max-w-lg mx-auto space-y-5">

            <!-- Header -->
            <div class="text-center mt-4 mb-2 relative">
                <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-32 h-32 bg-amber-500/10 blur-3xl rounded-full"></div>
                <i class="fas fa-kaaba text-5xl text-amber-400 drop-shadow-[0_0_25px_rgba(251,191,36,0.6)] mb-3 block animate-float relative z-10"></i>
                <h2 class="text-3xl font-amiri font-bold text-white relative z-10">Ø¯ÙØ¹ÙØ§Ø¡ÙŒ ÙˆÙÙ…ÙÙ†ÙØ§Ø¬ÙØ§Ø©</h2>
                <div class="h-0.5 w-16 bg-gradient-to-r from-transparent via-amber-500 to-transparent mx-auto rounded-full mt-2"></div>
            </div>

            <!-- Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø§Ù„Ø£Ø°Ø§Ù† -->
            <div class="glass-panel rounded-3xl p-5 space-y-4">
                <div class="flex items-center gap-3 pb-3 border-b border-amber-500/15">
                    <i class="fas fa-mosque text-xl text-amber-400"></i>
                    <h3 class="font-bold text-xl font-kufi text-white">Ù…ÙÙˆÙØ§Ù‚ÙÙŠØªÙ Ø§Ù„ØµÙÙ‘Ù„Ø§ÙØ©</h3>
                    <span id="azanDateLabel" class="mr-auto text-xs text-amber-400/50 font-kufi"></span>
                </div>

                <!-- City tabs -->
                <div class="flex gap-2 bg-black/30 p-1 rounded-2xl">
                    <button onclick="window.selectCity('cairo')" id="tab-cairo"
                        class="city-tab flex-1 py-2.5 rounded-xl font-kufi text-sm font-bold transition-all bg-amber-500 text-black shadow-md">
                        Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©
                    </button>
                    <button onclick="window.selectCity('alex')" id="tab-alex"
                        class="city-tab flex-1 py-2.5 rounded-xl font-kufi text-sm font-bold transition-all text-white/50 hover:text-white">
                        Ø§Ù„Ø¥Ø³ÙƒÙ†Ø¯Ø±ÙŠØ©
                    </button>
                    <button onclick="window.selectCity('mansoura')" id="tab-mansoura"
                        class="city-tab flex-1 py-2.5 rounded-xl font-kufi text-sm font-bold transition-all text-white/50 hover:text-white">
                        Ø§Ù„Ù…Ù†ØµÙˆØ±Ø©
                    </button>
                </div>

                <!-- Times grid -->
                <div class="grid grid-cols-3 gap-3">
                    <div class="bg-black/30 border border-amber-500/10 rounded-2xl p-3 text-center">
                        <div class="text-xs text-amber-400/60 font-kufi mb-1">Ø§Ù„ÙÙØ¬Ù’Ø± ğŸŒ™</div>
                        <div class="text-lg font-bold text-white font-amiri" id="az-fajr">--:--</div>
                    </div>
                    <div class="bg-black/30 border border-amber-500/10 rounded-2xl p-3 text-center">
                        <div class="text-xs text-amber-400/60 font-kufi mb-1">Ø§Ù„Ø´ÙÙ‘Ø±ÙÙˆÙ‚ â˜€ï¸</div>
                        <div class="text-lg font-bold text-white font-amiri" id="az-sunrise">--:--</div>
                    </div>
                    <div class="bg-black/30 border border-amber-500/10 rounded-2xl p-3 text-center">
                        <div class="text-xs text-amber-400/60 font-kufi mb-1">Ø§Ù„Ø¸ÙÙ‘Ù‡Ù’Ø± ğŸ•›</div>
                        <div class="text-lg font-bold text-white font-amiri" id="az-dhuhr">--:--</div>
                    </div>
                    <div class="bg-black/30 border border-amber-500/10 rounded-2xl p-3 text-center">
                        <div class="text-xs text-amber-400/60 font-kufi mb-1">Ø§Ù„Ø¹ÙØµÙ’Ø± ğŸŒ¤ï¸</div>
                        <div class="text-lg font-bold text-white font-amiri" id="az-asr">--:--</div>
                    </div>
                    <div class="bg-amber-500/15 border border-amber-400/40 rounded-2xl p-3 text-center relative overflow-hidden">
                        <div class="absolute inset-0 bg-amber-400/5 animate-pulse rounded-2xl"></div>
                        <div class="text-xs text-amber-300 font-kufi mb-1 font-bold relative z-10">Ø§Ù„Ø¥ÙÙÙ’Ø·ÙØ§Ø± ğŸŒ…</div>
                        <div class="text-xl font-bold text-amber-300 font-amiri relative z-10" id="az-maghrib">--:--</div>
                    </div>
                    <div class="bg-black/30 border border-amber-500/10 rounded-2xl p-3 text-center">
                        <div class="text-xs text-amber-400/60 font-kufi mb-1">Ø§Ù„Ø¹ÙØ´ÙØ§Ø¡ ğŸŒƒ</div>
                        <div class="text-lg font-bold text-white font-amiri" id="az-isha">--:--</div>
                    </div>
                </div>

                <!-- Countdown to iftar -->
                <div id="iftarCountdown" class="text-center py-2 text-sm font-kufi text-amber-400/70 hidden">
                    <i class="fas fa-hourglass-half ml-1 text-amber-400"></i>
                    <span id="iftarCountdownText"></span>
                </div>
            </div>

            <!-- Ø¯Ø¹Ø§Ø¡ Ø§Ù„Ø¥ÙØ·Ø§Ø± -->
            <div class="glass-panel rounded-3xl p-5 relative overflow-hidden">
                <div class="absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-transparent via-amber-400 to-transparent opacity-50 rounded-t-3xl"></div>
                <div class="flex items-center gap-3 pb-3 border-b border-amber-500/15 mb-4">
                    <span class="text-2xl">ğŸŒ…</span>
                    <h3 class="font-bold text-xl font-kufi text-amber-300">Ø¯ÙØ¹ÙØ§Ø¡Ù Ø§Ù„Ø¥ÙÙÙ’Ø·ÙØ§Ø±</h3>
                </div>
                <p class="font-amiri text-2xl text-white leading-[2.4] text-center mb-4 tracking-wide">
                    Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ Ù„ÙÙƒÙ ØµÙÙ…Ù’ØªÙØŒ ÙˆÙØ¹ÙÙ„ÙÙ‰ Ø±ÙØ²Ù’Ù‚ÙÙƒÙ Ø£ÙÙÙ’Ø·ÙØ±Ù’ØªÙØŒ
                    <br>Ø°ÙÙ‡ÙØ¨Ù Ø§Ù„Ø¸ÙÙ‘Ù…ÙØ£Ù ÙˆÙØ§Ø¨Ù’ØªÙÙ„ÙÙ‘ØªÙ Ø§Ù„Ù’Ø¹ÙØ±ÙÙˆÙ‚ÙØŒ
                    <br>ÙˆÙØ«ÙØ¨ÙØªÙ Ø§Ù„Ø£ÙØ¬Ù’Ø±Ù Ø¥ÙÙ†Ù’ Ø´ÙØ§Ø¡Ù Ø§Ù„Ù„ÙÙ‘Ù‡
                </p>
                <div class="text-center text-xs text-amber-400/50 font-amiri">Ø±ÙˆØ§Ù‡ Ø£Ø¨Ùˆ Ø¯Ø§ÙˆØ¯</div>
            </div>

            <!-- Ø¯Ø¹Ø§Ø¡ Ù„ÙŠÙ„Ø© Ø§Ù„Ù‚Ø¯Ø± -->
            <div class="glass-panel rounded-3xl p-5 relative overflow-hidden">
                <div class="flex items-center gap-3 pb-3 border-b border-amber-500/15 mb-4">
                    <span class="text-2xl">ğŸŒ™</span>
                    <h3 class="font-bold text-xl font-kufi text-amber-300">Ø¯ÙØ¹ÙØ§Ø¡Ù Ù„ÙÙŠÙ’Ù„ÙØ©Ù Ø§Ù„Ù’Ù‚ÙØ¯Ù’Ø±</h3>
                </div>
                <p class="font-amiri text-2xl text-white leading-[2.4] text-center tracking-wide">
                    Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ Ø¥ÙÙ†ÙÙ‘ÙƒÙ Ø¹ÙÙÙÙˆÙŒÙ‘ ÙƒÙØ±ÙÙŠÙ…ØŒ
                    <br>ØªÙØ­ÙØ¨ÙÙ‘ Ø§Ù„Ù’Ø¹ÙÙÙ’ÙˆÙ ÙÙØ§Ø¹Ù’ÙÙ Ø¹ÙÙ†ÙÙ‘ÙŠ
                </p>
                <div class="text-center text-xs text-amber-400/50 font-amiri mt-3">Ø±ÙˆØ§Ù‡ Ø§Ù„ØªØ±Ù…Ø°ÙŠ ÙˆØµØ­Ø­Ù‡</div>
            </div>

            <!-- Ø£Ø¯Ø¹ÙŠØ© Ù…Ø®ØªØ§Ø±Ø© -->
            <div class="glass-panel rounded-3xl p-5 space-y-4">
                <div class="flex items-center gap-3 pb-3 border-b border-amber-500/15">
                    <i class="fas fa-book-open text-xl text-amber-400"></i>
                    <h3 class="font-bold text-xl font-kufi text-white">Ø£ÙØ¯Ù’Ø¹ÙÙŠÙØ©ÙŒ Ù…ÙØ®Ù’ØªÙØ§Ø±ÙØ©</h3>
                </div>
                <div class="space-y-3">
                    <div class="dua-card p-4 bg-black/30 rounded-2xl border border-white/5 hover:border-amber-500/30 active:scale-[0.98] transition-all cursor-pointer text-right" onclick="window.copyDua(this)">
                        <p class="font-amiri text-xl text-white leading-[2.2]">Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ Ø£ÙØ¹ÙÙ†ÙÙ‘ÙŠ Ø¹ÙÙ„ÙÙ‰ Ø°ÙÙƒÙ’Ø±ÙÙƒÙ ÙˆÙØ´ÙÙƒÙ’Ø±ÙÙƒÙ ÙˆÙØ­ÙØ³Ù’Ù†Ù Ø¹ÙØ¨ÙØ§Ø¯ÙØªÙÙƒ</p>
                        <div class="text-xs text-amber-400/40 font-kufi mt-2 flex items-center gap-1"><i class="fas fa-copy text-[10px]"></i> Ø§Ø¶ØºØ· Ù„Ù„Ù†Ø³Ø®</div>
                    </div>
                    <div class="dua-card p-4 bg-black/30 rounded-2xl border border-white/5 hover:border-amber-500/30 active:scale-[0.98] transition-all cursor-pointer text-right" onclick="window.copyDua(this)">
                        <p class="font-amiri text-xl text-white leading-[2.2]">Ø±ÙØ¨ÙÙ‘Ù†ÙØ§ Ø¢ØªÙÙ†ÙØ§ ÙÙÙŠ Ø§Ù„Ø¯ÙÙ‘Ù†Ù’ÙŠÙØ§ Ø­ÙØ³ÙÙ†ÙØ©Ù‹ ÙˆÙÙÙÙŠ Ø§Ù„Ù’Ø¢Ø®ÙØ±ÙØ©Ù Ø­ÙØ³ÙÙ†ÙØ©Ù‹ ÙˆÙÙ‚ÙÙ†ÙØ§ Ø¹ÙØ°ÙØ§Ø¨Ù Ø§Ù„Ù†ÙÙ‘Ø§Ø±</p>
                        <div class="text-xs text-amber-400/40 font-kufi mt-2 flex items-center gap-1"><i class="fas fa-copy text-[10px]"></i> Ø§Ø¶ØºØ· Ù„Ù„Ù†Ø³Ø®</div>
                    </div>
                    <div class="dua-card p-4 bg-black/30 rounded-2xl border border-white/5 hover:border-amber-500/30 active:scale-[0.98] transition-all cursor-pointer text-right" onclick="window.copyDua(this)">
                        <p class="font-amiri text-xl text-white leading-[2.2]">Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ Ø§Ù‡Ù’Ø¯ÙÙ†ÙÙŠ ÙˆÙØ³ÙØ¯ÙÙ‘Ø¯Ù’Ù†ÙÙŠØŒ Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ Ø¥ÙÙ†ÙÙ‘ÙŠ Ø£ÙØ³Ù’Ø£ÙÙ„ÙÙƒÙ Ø§Ù„Ù’Ù‡ÙØ¯ÙÙ‰ ÙˆÙØ§Ù„Ø³ÙÙ‘Ø¯ÙØ§Ø¯</p>
                        <div class="text-xs text-amber-400/40 font-kufi mt-2 flex items-center gap-1"><i class="fas fa-copy text-[10px]"></i> Ø§Ø¶ØºØ· Ù„Ù„Ù†Ø³Ø®</div>
                    </div>
                    <div class="dua-card p-4 bg-black/30 rounded-2xl border border-white/5 hover:border-amber-500/30 active:scale-[0.98] transition-all cursor-pointer text-right" onclick="window.copyDua(this)">
                        <p class="font-amiri text-xl text-white leading-[2.2]">Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ ØªÙÙ‚ÙØ¨ÙÙ‘Ù„Ù’ ØµÙÙŠÙØ§Ù…ÙÙ†ÙØ§ ÙˆÙÙ‚ÙÙŠÙØ§Ù…ÙÙ†ÙØ§ ÙˆÙØ§Ø¬Ù’Ø¹ÙÙ„Ù’Ù†ÙØ§ Ù…ÙÙ†Ù’ Ø¹ÙØªÙÙ‚ÙØ§Ø¦ÙÙƒÙ Ù…ÙÙ†Ù Ø§Ù„Ù†ÙÙ‘Ø§Ø±</p>
                        <div class="text-xs text-amber-400/40 font-kufi mt-2 flex items-center gap-1"><i class="fas fa-copy text-[10px]"></i> Ø§Ø¶ØºØ· Ù„Ù„Ù†Ø³Ø®</div>
                    </div>
                    <div class="dua-card p-4 bg-black/30 rounded-2xl border border-white/5 hover:border-amber-500/30 active:scale-[0.98] transition-all cursor-pointer text-right" onclick="window.copyDua(this)">
                        <p class="font-amiri text-xl text-white leading-[2.2]">Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ Ø¥ÙÙ†ÙÙ‘ÙŠ Ø£ÙØ³Ù’Ø£ÙÙ„ÙÙƒÙ Ø§Ù„Ù’Ø¬ÙÙ†ÙÙ‘Ø©Ù ÙˆÙÙ…ÙØ§ Ù‚ÙØ±ÙÙ‘Ø¨Ù Ø¥ÙÙ„ÙÙŠÙ’Ù‡ÙØ§ Ù…ÙÙ†Ù’ Ù‚ÙÙˆÙ’Ù„Ù Ø£ÙÙˆÙ’ Ø¹ÙÙ…ÙÙ„ØŒ ÙˆÙØ£ÙØ¹ÙÙˆØ°Ù Ø¨ÙÙƒÙ Ù…ÙÙ†Ù Ø§Ù„Ù†ÙÙ‘Ø§Ø±Ù ÙˆÙÙ…ÙØ§ Ù‚ÙØ±ÙÙ‘Ø¨Ù Ø¥ÙÙ„ÙÙŠÙ’Ù‡ÙØ§ Ù…ÙÙ†Ù’ Ù‚ÙÙˆÙ’Ù„Ù Ø£ÙÙˆÙ’ Ø¹ÙÙ…ÙÙ„</p>
                        <div class="text-xs text-amber-400/40 font-kufi mt-2 flex items-center gap-1"><i class="fas fa-copy text-[10px]"></i> Ø§Ø¶ØºØ· Ù„Ù„Ù†Ø³Ø®</div>
                    </div>
                    <div class="dua-card p-4 bg-black/30 rounded-2xl border border-white/5 hover:border-amber-500/30 active:scale-[0.98] transition-all cursor-pointer text-right" onclick="window.copyDua(this)">
                        <p class="font-amiri text-xl text-white leading-[2.2]">Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ Ø¨ÙÙ„ÙÙ‘ØºÙ’Ù†ÙØ§ Ø±ÙÙ…ÙØ¶ÙØ§Ù†ØŒ ÙˆÙØ¨ÙÙ„ÙÙ‘ØºÙ’Ù†ÙØ§ Ù„ÙÙŠÙ’Ù„ÙØ©Ù Ø§Ù„Ù’Ù‚ÙØ¯Ù’Ø±ØŒ ÙˆÙØ§Ø¬Ù’Ø¹ÙÙ„Ù’Ù†ÙØ§ Ù…ÙÙ†Ù Ø§Ù„Ù’ÙÙØ§Ø¦ÙØ²ÙÙŠÙ†</p>
                        <div class="text-xs text-amber-400/40 font-kufi mt-2 flex items-center gap-1"><i class="fas fa-copy text-[10px]"></i> Ø§Ø¶ØºØ· Ù„Ù„Ù†Ø³Ø®</div>
                    </div>
                </div>
            </div>

            <!-- ØµØ¯Ù‚Ø© Ø¬Ø§Ø±ÙŠØ© -->
            <div class="glass-panel p-6 rounded-3xl relative overflow-hidden text-center">
                <div class="absolute top-0 right-0 w-32 h-32 bg-amber-500/5 rounded-full blur-3xl"></div>
                <div class="text-base font-bold text-amber-400 mb-4 font-kufi">ğŸ’› ØµÙØ¯ÙÙ‚ÙØ©ÙŒ Ø¬ÙØ§Ø±ÙÙŠÙØ©</div>
                <p class="font-amiri text-xl text-white/85 leading-[2.4] relative z-10 mb-6 tracking-wide">
                    Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ Ø§ØºÙ’ÙÙØ±Ù’ Ù„ÙÙ…ÙÙˆÙ’ØªÙØ§Ù†ÙØ§ ÙˆÙÙ…ÙÙˆÙ’ØªÙÙ‰ Ø§Ù„Ù’Ù…ÙØ³Ù’Ù„ÙÙ…ÙÙŠÙ†ØŒ
                    <br>ÙˆÙØ§Ø±Ù’Ø­ÙÙ…Ù’Ù‡ÙÙ…Ù’ Ø¨ÙØ±ÙØ­Ù’Ù…ÙØªÙÙƒÙ Ø§Ù„ÙÙ‘ØªÙÙŠ ÙˆÙØ³ÙØ¹ÙØªÙ’ ÙƒÙÙ„ÙÙ‘ Ø´ÙÙŠÙ’Ø¡ØŒ
                    <br>ÙˆÙØ§Ø¬Ù’Ø¹ÙÙ„Ù’ Ù‚ÙØ¨ÙÙˆØ±ÙÙ‡ÙÙ…Ù’ Ø±ÙÙˆÙ’Ø¶ÙØ©Ù‹ Ù…ÙÙ†Ù’ Ø±ÙÙŠÙØ§Ø¶Ù Ø§Ù„Ù’Ø¬ÙÙ†ÙÙ‘Ø©
                </p>
                <div class="font-amiri text-xl font-bold text-white space-y-3 leading-relaxed relative z-10">
                    <div class="py-2 border-b border-amber-500/15">Ø¹ÙØ·ÙÙŠÙÙ‘Ø© Ø¥ÙØ¨Ù’Ø±ÙØ§Ù‡ÙÙŠÙ…</div>
                    <div class="text-amber-300 py-2 border-b border-amber-500/15">Ø£ÙØ­Ù’Ù…ÙØ¯ Ù…ÙØ­ÙÙ…ÙÙ‘Ø¯ Ø§Ù„Ø³ÙÙ‘ÙŠÙÙ‘Ø¯ Ø¹ÙÙ„ÙÙŠÙˆÙÙ‡</div>
                    <div class="py-2">Ø­ÙÙ…Ù’Ø²ÙØ© Ù…ÙØ­ÙÙ…ÙÙ‘Ø¯ Ø¥ÙØ¨Ù’Ø±ÙØ§Ù‡ÙÙŠÙ…</div>
                </div>
            </div>

            ${FOOTER_HTML}
        </div>`;
    }

    function getFemaleTemplate() {
        return `
        <!-- Bottom Nav -->
        <header class="fixed bottom-0 left-0 right-0 z-50 bg-[#150824]/96 backdrop-blur-2xl border-t border-fuchsia-500/15 pb-safe shadow-[0_-8px_24px_rgba(0,0,0,0.7)]">
            <nav class="flex justify-around items-center max-w-md mx-auto font-kufi text-sm font-bold px-2 py-3">
                <button onclick="window.toggleView('dashboard')" id="nav-dashboard" class="nav-item active flex flex-col items-center gap-1 text-fuchsia-400 transition-all min-w-[56px]">
                    <i class="fas fa-home text-xl"></i><span class="text-xs">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span>
                </button>
                <button onclick="window.toggleView('quran')" id="nav-quran" class="nav-item flex flex-col items-center gap-1 text-white/50 hover:text-white transition-all min-w-[56px]">
                    <i class="fas fa-book-quran text-xl"></i><span class="text-xs">Ø§Ù„Ù‚Ø±Ø¢Ù†</span>
                </button>
                <div class="flex flex-col items-center gap-1 text-white/60 px-1">
                    <div class="flex items-center gap-1">
                        <i class="fas fa-heart text-fuchsia-400 text-base"></i>
                        <span class="font-bold text-white font-amiri text-lg" id="streakCount">0</span>
                    </div>
                    <span class="text-[10px] text-white/30">ÙŠÙˆÙ…</span>
                </div>
                <button onclick="window.toggleView('duaa')" id="nav-duaa" class="nav-item flex flex-col items-center gap-1 text-white/50 hover:text-white transition-all min-w-[56px]">
                    <i class="fas fa-hands-praying text-xl"></i><span class="text-xs">Ø£Ø¯Ø¹ÙŠØªÙŠ</span>
                </button>
            </nav>
        </header>

        <div id="dashboard-view" class="animate-fade-in px-4 max-w-lg mx-auto space-y-6 pb-36">
            
            <div class="text-center space-y-2 pt-2">
                <h2 class="text-3xl font-bold font-kufi text-white">Ø£Ù‡Ù„Ø§Ù‹ Ø¨ÙƒÙ ${currentUser} âœ¨</h2>
                <p class="text-fuchsia-300/70 font-amiri text-base">Ù†ÙˆØ± Ø§Ù„Ù„Ù‡ Ù‚Ù„Ø¨ÙƒÙ ÙˆØªÙ‚Ø¨Ù„ Ø·Ø§Ø¹ØªÙƒÙ</p>
            </div>

            <!-- Date Navigator -->
            <div class="flex items-center justify-between bg-[#220d3a]/80 border border-fuchsia-500/20 rounded-2xl p-2 shadow-lg backdrop-blur-sm">
                <button onclick="window.changeDate(1)" class="w-11 h-11 flex items-center justify-center rounded-xl bg-[#2d114d] text-fuchsia-300 active:bg-[#3a1663] transition-all active:scale-90">
                    <i class="fas fa-chevron-right text-sm"></i>
                </button>
                <div class="text-center">
                    <span id="dateDisplay" class="font-bold text-base font-kufi text-white block">...</span>
                    <span id="dateTag" class="text-xs text-fuchsia-400/60 font-amiri">Ø§Ù„ÙŠÙˆÙ…</span>
                </div>
                <button onclick="window.changeDate(-1)" class="w-11 h-11 flex items-center justify-center rounded-xl bg-[#2d114d] text-fuchsia-300 active:bg-[#3a1663] transition-all active:scale-90">
                    <i class="fas fa-chevron-left text-sm"></i>
                </button>
            </div>

            <!-- Prayers -->
            <div class="glass-card rounded-3xl p-5 space-y-5">
                <div class="flex items-center gap-3 pb-3 border-b border-fuchsia-500/15">
                    <i class="fas fa-mosque text-xl text-fuchsia-400"></i>
                    <h3 class="font-bold text-xl font-kufi text-white">ØµÙ„ÙˆØ§ØªÙƒÙ Ø§Ù„ÙŠÙˆÙ…</h3>
                    <span id="prayerProgress" class="mr-auto text-xs font-bold text-fuchsia-300/70 bg-fuchsia-500/10 px-3 py-1 rounded-lg font-kufi">0/5 ÙØ±ÙˆØ¶</span>
                </div>
                <div id="prayersList" class="space-y-3"></div>
            </div>

            <!-- Habits -->
            <div class="glass-card rounded-3xl p-5 space-y-5">
                <div class="flex items-center gap-3 pb-3 border-b border-fuchsia-500/15">
                    <i class="fas fa-sparkles text-xl text-fuchsia-400"></i>
                    <h3 class="font-bold text-xl font-kufi text-white">Ø£Ø°ÙƒØ§Ø±ÙƒÙ ÙˆÙˆÙØ±Ø¯ÙƒÙ</h3>
                </div>
                <div class="space-y-3">
                    <div id="f_morning" onclick="window.toggleHabit('f_morning')" class="prayer-row cursor-pointer select-none" role="button">
                        <div class="flex items-center gap-3">
                            <div class="w-10 h-10 rounded-xl bg-fuchsia-500/10 flex items-center justify-center flex-shrink-0">
                                <i class="fas fa-cloud-sun text-fuchsia-400"></i>
                            </div>
                            <span class="text-lg font-amiri font-bold text-white">Ø£Ø°ÙƒØ§Ø± Ø§Ù„ØµØ¨Ø§Ø­</span>
                        </div>
                        <div class="check-circle w-9 h-9 rounded-full border-2 border-white/20 flex items-center justify-center transition-all flex-shrink-0">
                            <i class="fas fa-check text-sm opacity-0 text-white"></i>
                        </div>
                    </div>
                    <div id="f_evening" onclick="window.toggleHabit('f_evening')" class="prayer-row cursor-pointer select-none" role="button">
                        <div class="flex items-center gap-3">
                            <div class="w-10 h-10 rounded-xl bg-fuchsia-500/10 flex items-center justify-center flex-shrink-0">
                                <i class="fas fa-moon text-fuchsia-400"></i>
                            </div>
                            <span class="text-lg font-amiri font-bold text-white">Ø£Ø°ÙƒØ§Ø± Ø§Ù„Ù…Ø³Ø§Ø¡</span>
                        </div>
                        <div class="check-circle w-9 h-9 rounded-full border-2 border-white/20 flex items-center justify-center transition-all flex-shrink-0">
                            <i class="fas fa-check text-sm opacity-0 text-white"></i>
                        </div>
                    </div>
                    <div id="f_taraweeh" onclick="window.toggleHabit('f_taraweeh')" class="night-glow-f-card p-4 rounded-2xl flex items-center justify-between cursor-pointer transition-all select-none" role="button">
                        <div class="flex items-center gap-4">
                            <div class="w-12 h-12 rounded-full bg-fuchsia-500/15 flex items-center justify-center flex-shrink-0">
                                <i class="fas fa-star-and-crescent text-fuchsia-400 text-lg"></i>
                            </div>
                            <div>
                                <span class="text-xl font-bold font-kufi block text-white">Ù†ÙˆØ± Ø§Ù„Ù„ÙŠÙ„Ø©</span>
                                <span class="text-xs text-fuchsia-300/50 font-amiri">ØµÙ„Ø§Ø© Ø§Ù„ØªØ±Ø§ÙˆÙŠØ­</span>
                            </div>
                        </div>
                        <div class="check-circle w-10 h-10 rounded-full border-2 border-fuchsia-400/25 flex items-center justify-center transition-all flex-shrink-0">
                            <i class="fas fa-check text-lg opacity-0 text-white"></i>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quran + Study -->
            <div class="glass-card rounded-3xl p-5 space-y-4">
                <div class="flex items-center gap-3 pb-3 border-b border-fuchsia-500/15">
                    <i class="fas fa-book-open text-xl text-fuchsia-400"></i>
                    <h3 class="font-bold text-xl font-kufi text-white">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ÙŠÙˆÙ…</h3>
                </div>
                <div class="grid grid-cols-2 gap-3">
                    <div class="bg-[#220d3a] p-4 rounded-2xl border border-fuchsia-500/10 text-center">
                        <div class="text-xs font-bold text-fuchsia-300/70 mb-2 font-kufi">ØµÙØ­Ø§Øª Ø§Ù„Ù‚Ø±Ø¢Ù†</div>
                        <input type="number" id="quranInput" placeholder="0" inputmode="numeric"
                            class="w-full bg-transparent text-white text-4xl font-bold text-center focus:outline-none placeholder-white/10 font-amiri"
                            onchange="window.onInputChange()" oninput="window.onInputChange()">
                        <div class="text-xs text-white/15 mt-1 font-amiri">ØµÙØ­Ø©</div>
                    </div>
                    <div class="bg-[#220d3a] p-4 rounded-2xl border border-fuchsia-500/10 text-center">
                        <div class="text-xs font-bold text-fuchsia-300/70 mb-2 font-kufi">Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø¯Ø±Ø§Ø³Ø©</div>
                        <input type="number" id="workInput" placeholder="0" inputmode="decimal"
                            class="w-full bg-transparent text-white text-4xl font-bold text-center focus:outline-none placeholder-white/10 font-amiri"
                            onchange="window.onInputChange()" oninput="window.onInputChange()">
                        <div class="text-xs text-white/15 mt-1 font-amiri">Ø³Ø§Ø¹Ø©</div>
                    </div>
                </div>
            </div>

            <!-- Daily Ring -->
            <div class="glass-card rounded-3xl p-6 space-y-8 relative overflow-hidden">
                <div class="text-center relative z-10">
                    <h3 class="text-2xl font-bold font-kufi text-white">Ø¥Ø´Ø±Ø§Ù‚ØªÙƒÙ Ø§Ù„Ø±ÙˆØ­ÙŠØ©</h3>
                    <div class="h-0.5 w-12 bg-fuchsia-500/40 mx-auto rounded-full mt-2"></div>
                </div>

                <div class="relative w-56 h-56 mx-auto">
                    <div class="absolute inset-0 bg-fuchsia-500/8 blur-[35px] rounded-full animate-slow-glow"></div>
                    <svg class="w-full h-full -rotate-90 relative z-10" viewBox="0 0 256 256">
                        <circle cx="128" cy="128" r="110" stroke="rgba(255,255,255,0.05)" stroke-width="10" fill="none"/>
                        <circle id="performanceRing" cx="128" cy="128" r="110" stroke="#f0abfc" stroke-width="14" fill="none" stroke-dasharray="691" stroke-dashoffset="691" stroke-linecap="round"/>
                    </svg>
                    <div class="absolute inset-0 flex flex-col items-center justify-center text-center z-20">
                        <span id="performancePct" class="text-5xl font-bold text-white font-kufi">0%</span>
                        <span id="performanceLabel" class="text-sm font-amiri text-fuchsia-300 mt-1">Ù‚Ø±Ø¨ÙŒ Ø¬Ù…ÙŠÙ„</span>
                    </div>
                </div>

                <div class="bg-[#220d3a] p-5 rounded-2xl border border-fuchsia-500/10">
                    <div class="flex justify-between items-center mb-3">
                        <span class="text-sm font-bold text-white/60 font-kufi">Ù…Ø³Ø§Ø± Ø®ØªÙ…Ø© Ø§Ù„Ù‚Ø±Ø¢Ù†</span>
                        <span id="khatmaLabel" class="text-xs font-bold text-fuchsia-300 bg-fuchsia-500/10 px-3 py-1 rounded-lg font-kufi">Ø§Ù„Ø¬Ø²Ø¡ 1</span>
                    </div>
                    <div class="relative h-2.5 bg-black/50 rounded-full overflow-hidden border border-white/5 mb-3">
                        <div id="khatmaBar" class="absolute top-0 right-0 h-full bg-fuchsia-400 rounded-full shadow-[0_0_12px_rgba(232,121,249,0.6)] transition-all duration-1000" style="width:0%"></div>
                    </div>
                    <div class="flex justify-between text-center">
                        <div>
                            <div class="text-xs text-fuchsia-300/50 font-kufi">Ù‚ÙØ±Ø¦Øª</div>
                            <div id="currentPages" class="text-2xl font-bold text-white font-amiri">0</div>
                        </div>
                        <div>
                            <div class="text-xs text-white/30 font-kufi">Ù…ØªØ¨Ù‚ÙŠ</div>
                            <div id="remainingPages" class="text-2xl font-bold text-white/40 font-amiri">604</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Month Harvest -->
            <div class="glass-card rounded-3xl p-5 space-y-4">
                <div class="flex items-center gap-3 pb-3 border-b border-fuchsia-500/15">
                    <i class="fas fa-chart-bar text-xl text-fuchsia-400"></i>
                    <h3 class="font-bold text-xl font-kufi text-white">Ø­ØµØ§Ø¯ Ø§Ù„Ø´Ù‡Ø± Ø§Ù„Ù…Ø¨Ø§Ø±Ùƒ</h3>
                </div>
                <div class="grid grid-cols-2 gap-3">
                    <div class="bg-[#220d3a] p-4 rounded-2xl border border-fuchsia-500/10 text-center">
                        <div class="text-3xl font-bold text-white font-amiri" id="monthFard">0</div>
                        <div class="text-xs text-fuchsia-300/70 mt-1 font-kufi">ÙØ±ÙˆØ¶ Ù…Ø¤Ø¯Ø§Ø©</div>
                    </div>
                    <div class="bg-[#220d3a] p-4 rounded-2xl border border-fuchsia-500/10 text-center">
                        <div class="text-3xl font-bold text-white font-amiri" id="monthSunnah">0</div>
                        <div class="text-xs text-fuchsia-300/70 mt-1 font-kufi">Ø³Ù†Ù† ÙˆÙ†ÙˆØ§ÙÙ„</div>
                    </div>
                    <div class="bg-[#220d3a] p-4 rounded-2xl border border-fuchsia-500/10 text-center">
                        <div class="text-3xl font-bold text-white font-amiri" id="monthTaraweeh">0</div>
                        <div class="text-xs text-fuchsia-300/70 mt-1 font-kufi">Ø£ÙŠØ§Ù… Ø§Ù„ØªØ±Ø§ÙˆÙŠØ­</div>
                    </div>
                    <div class="bg-gradient-to-br from-fuchsia-500/15 to-transparent p-4 rounded-2xl border border-fuchsia-500/25 text-center">
                        <div class="text-3xl font-bold text-fuchsia-400 font-amiri" id="monthScore">0%</div>
                        <div class="text-xs text-fuchsia-400 mt-1 font-kufi font-bold">Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø§Ù„Ø¹Ø§Ù…</div>
                    </div>
                </div>
            </div>

            <!-- Save -->
            <button onclick="window.saveData()" id="saveBtn" class="w-full bg-gradient-to-r from-fuchsia-500 to-purple-600 hover:from-fuchsia-400 hover:to-purple-500 active:from-fuchsia-600 active:to-purple-700 text-white font-extrabold font-kufi py-5 rounded-2xl text-xl shadow-[0_5px_20px_rgba(217,70,239,0.35)] transition-all active:scale-95 border-b-4 border-purple-900">
                âœ¨ Ø­ÙØ¸ ÙŠÙˆÙ…ÙŠØ§ØªÙŠ
            </button>

            <div class="flex justify-center gap-8 py-2">
                <button onclick="window.goHome()" class="text-sm text-white/40 hover:text-white transition-all font-kufi">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ</button>
                <button onclick="window.resetData()" class="text-sm text-red-500/50 hover:text-red-400 transition-all font-kufi">ØªØµÙÙŠØ± Ø§Ù„Ø³Ø¬Ù„</button>
            </div>
            
            ${FOOTER_HTML}
        </div>

        <!-- Quran View (female) -->
        <div id="quran-view" class="hidden animate-fade-in pb-32 px-4 max-w-lg mx-auto space-y-4">

            <div class="text-center mt-4 mb-2 relative">
                <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-32 h-32 bg-fuchsia-500/8 blur-3xl rounded-full"></div>
                <i class="fas fa-book-quran text-5xl text-fuchsia-400 drop-shadow-[0_0_25px_rgba(240,171,252,0.5)] mb-3 block animate-float relative z-10"></i>
                <h2 class="text-3xl font-amiri font-bold text-white relative z-10">Ø§Ù„Ù‚ÙØ±Ù’Ø¢Ù†Ù Ø§Ù„ÙƒÙØ±ÙÙŠÙ…</h2>
                <div class="h-0.5 w-16 bg-gradient-to-r from-transparent via-fuchsia-500 to-transparent mx-auto rounded-full mt-2"></div>
            </div>

            <div class="glass-card rounded-3xl p-4 space-y-3">
                <div class="flex gap-2">
                    <select id="surahSelect" onchange="window.loadSurah()"
                        class="flex-1 bg-black/50 border border-fuchsia-500/25 rounded-2xl px-4 py-3 text-white font-amiri text-base focus:outline-none focus:border-fuchsia-400 transition-all appearance-none text-right cursor-pointer">
                        <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø³ÙˆØ±Ø©...</option>
                    </select>
                    <div class="flex gap-2">
                        <button onclick="window.changeFontSize(-1)" class="w-11 h-11 rounded-xl bg-black/40 border border-fuchsia-500/20 text-fuchsia-400 font-bold text-lg active:scale-90 transition-all">Ù€</button>
                        <button onclick="window.changeFontSize(1)"  class="w-11 h-11 rounded-xl bg-black/40 border border-fuchsia-500/20 text-fuchsia-400 font-bold text-lg active:scale-90 transition-all">+</button>
                    </div>
                </div>
                <div id="surahInfo" class="hidden flex items-center justify-between text-xs font-kufi px-1">
                    <span id="surahNameAr" class="text-fuchsia-400 font-bold text-sm font-amiri"></span>
                    <span id="surahVerseCount" class="text-white/40"></span>
                </div>
            </div>

            <div id="quranLoading" class="hidden text-center py-12">
                <div class="w-10 h-10 border-3 border-fuchsia-500/30 border-t-fuchsia-400 rounded-full animate-spin mx-auto mb-3"></div>
                <p class="text-fuchsia-400/60 font-amiri text-lg">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³ÙˆØ±Ø©...</p>
            </div>

            <div id="quranContainer" class="glass-card rounded-3xl p-5 hidden">
                <div id="bismillah" class="text-center mb-6 py-4 border-b border-fuchsia-500/15">
                    <p class="font-amiri text-3xl text-fuchsia-200 leading-loose">Ø¨ÙØ³Ù’Ù…Ù Ø§Ù„Ù„ÙÙ‘Ù‡Ù Ø§Ù„Ø±ÙÙ‘Ø­Ù’Ù…ÙÙ°Ù†Ù Ø§Ù„Ø±ÙÙ‘Ø­ÙÙŠÙ…Ù</p>
                </div>
                <div id="quranVerses" class="space-y-5 text-right leading-[2.8]" style="font-size: 26px;"></div>
            </div>

            <div id="quranNavBar" class="hidden glass-card rounded-2xl p-3 flex items-center justify-between gap-2">
                <button onclick="window.prevSurah()" class="flex-shrink-0 w-10 h-10 rounded-xl bg-fuchsia-500/15 text-fuchsia-400 active:scale-90 transition-all">
                    <i class="fas fa-chevron-right"></i>
                </button>
                <span id="quranNavLabel" class="text-xs text-white/50 font-kufi text-center flex-1">Ø§Ù„Ø³ÙˆØ±Ø©</span>
                <button onclick="window.nextSurah()" class="flex-shrink-0 w-10 h-10 rounded-xl bg-fuchsia-500/15 text-fuchsia-400 active:scale-90 transition-all">
                    <i class="fas fa-chevron-left"></i>
                </button>
            </div>
        </div>

        <!-- Duaa View female -->
        <div id="duaa-view" class="hidden animate-fade-in pb-32 px-4 max-w-lg mx-auto space-y-5">

            <div class="text-center mt-4 mb-2 relative">
                <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-32 h-32 bg-fuchsia-500/10 blur-3xl rounded-full"></div>
                <i class="fas fa-kaaba text-5xl text-fuchsia-400 drop-shadow-[0_0_25px_rgba(240,171,252,0.6)] mb-3 block animate-float relative z-10"></i>
                <h2 class="text-3xl font-amiri font-bold text-white relative z-10">Ø¯ÙØ¹ÙØ§Ø¡ÙŒ ÙˆÙÙ…ÙÙ†ÙØ§Ø¬ÙØ§Ø©</h2>
                <div class="h-0.5 w-16 bg-gradient-to-r from-transparent via-fuchsia-500 to-transparent mx-auto rounded-full mt-2"></div>
            </div>

            <!-- Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø§Ù„Ø£Ø°Ø§Ù† -->
            <div class="glass-card rounded-3xl p-5 space-y-4">
                <div class="flex items-center gap-3 pb-3 border-b border-fuchsia-500/15">
                    <i class="fas fa-mosque text-xl text-fuchsia-400"></i>
                    <h3 class="font-bold text-xl font-kufi text-white">Ù…ÙÙˆÙØ§Ù‚ÙÙŠØªÙ Ø§Ù„ØµÙÙ‘Ù„Ø§ÙØ©</h3>
                    <span id="azanDateLabel" class="mr-auto text-xs text-fuchsia-400/50 font-kufi"></span>
                </div>

                <!-- City tabs -->
                <div class="flex gap-2 bg-black/30 p-1 rounded-2xl">
                    <button onclick="window.selectCity('cairo')" id="tab-cairo"
                        class="city-tab flex-1 py-2.5 rounded-xl font-kufi text-sm font-bold transition-all bg-fuchsia-500 text-white shadow-md">
                        Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©
                    </button>
                    <button onclick="window.selectCity('alex')" id="tab-alex"
                        class="city-tab flex-1 py-2.5 rounded-xl font-kufi text-sm font-bold transition-all text-white/50 hover:text-white">
                        Ø§Ù„Ø¥Ø³ÙƒÙ†Ø¯Ø±ÙŠØ©
                    </button>
                    <button onclick="window.selectCity('mansoura')" id="tab-mansoura"
                        class="city-tab flex-1 py-2.5 rounded-xl font-kufi text-sm font-bold transition-all text-white/50 hover:text-white">
                        Ø§Ù„Ù…Ù†ØµÙˆØ±Ø©
                    </button>
                </div>

                <!-- Times grid -->
                <div class="grid grid-cols-3 gap-3">
                    <div class="bg-black/30 border border-fuchsia-500/10 rounded-2xl p-3 text-center">
                        <div class="text-xs text-fuchsia-300/60 font-kufi mb-1">Ø§Ù„ÙÙØ¬Ù’Ø± ğŸŒ™</div>
                        <div class="text-lg font-bold text-white font-amiri" id="az-fajr">--:--</div>
                    </div>
                    <div class="bg-black/30 border border-fuchsia-500/10 rounded-2xl p-3 text-center">
                        <div class="text-xs text-fuchsia-300/60 font-kufi mb-1">Ø§Ù„Ø´ÙÙ‘Ø±ÙÙˆÙ‚ â˜€ï¸</div>
                        <div class="text-lg font-bold text-white font-amiri" id="az-sunrise">--:--</div>
                    </div>
                    <div class="bg-black/30 border border-fuchsia-500/10 rounded-2xl p-3 text-center">
                        <div class="text-xs text-fuchsia-300/60 font-kufi mb-1">Ø§Ù„Ø¸ÙÙ‘Ù‡Ù’Ø± ğŸ•›</div>
                        <div class="text-lg font-bold text-white font-amiri" id="az-dhuhr">--:--</div>
                    </div>
                    <div class="bg-black/30 border border-fuchsia-500/10 rounded-2xl p-3 text-center">
                        <div class="text-xs text-fuchsia-300/60 font-kufi mb-1">Ø§Ù„Ø¹ÙØµÙ’Ø± ğŸŒ¤ï¸</div>
                        <div class="text-lg font-bold text-white font-amiri" id="az-asr">--:--</div>
                    </div>
                    <div class="bg-fuchsia-500/15 border border-fuchsia-400/40 rounded-2xl p-3 text-center relative overflow-hidden">
                        <div class="absolute inset-0 bg-fuchsia-400/5 animate-pulse rounded-2xl"></div>
                        <div class="text-xs text-fuchsia-300 font-kufi mb-1 font-bold relative z-10">Ø§Ù„Ø¥ÙÙÙ’Ø·ÙØ§Ø± ğŸŒ…</div>
                        <div class="text-xl font-bold text-fuchsia-300 font-amiri relative z-10" id="az-maghrib">--:--</div>
                    </div>
                    <div class="bg-black/30 border border-fuchsia-500/10 rounded-2xl p-3 text-center">
                        <div class="text-xs text-fuchsia-300/60 font-kufi mb-1">Ø§Ù„Ø¹ÙØ´ÙØ§Ø¡ ğŸŒƒ</div>
                        <div class="text-lg font-bold text-white font-amiri" id="az-isha">--:--</div>
                    </div>
                </div>

                <!-- Countdown to iftar -->
                <div id="iftarCountdown" class="text-center py-2 text-sm font-kufi text-fuchsia-400/70 hidden">
                    <i class="fas fa-hourglass-half ml-1 text-fuchsia-400"></i>
                    <span id="iftarCountdownText"></span>
                </div>
            </div>

            <!-- Ø¯Ø¹Ø§Ø¡ Ø§Ù„Ø¥ÙØ·Ø§Ø± -->
            <div class="glass-card rounded-3xl p-5 relative overflow-hidden">
                <div class="absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-transparent via-fuchsia-400 to-transparent opacity-50 rounded-t-3xl"></div>
                <div class="flex items-center gap-3 pb-3 border-b border-fuchsia-500/15 mb-4">
                    <span class="text-2xl">ğŸŒ…</span>
                    <h3 class="font-bold text-xl font-kufi text-fuchsia-300">Ø¯ÙØ¹ÙØ§Ø¡Ù Ø§Ù„Ø¥ÙÙÙ’Ø·ÙØ§Ø±</h3>
                </div>
                <p class="font-amiri text-2xl text-white leading-[2.4] text-center mb-4 tracking-wide">
                    Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ Ù„ÙÙƒÙ ØµÙÙ…Ù’ØªÙØŒ ÙˆÙØ¹ÙÙ„ÙÙ‰ Ø±ÙØ²Ù’Ù‚ÙÙƒÙ Ø£ÙÙÙ’Ø·ÙØ±Ù’ØªÙØŒ
                    <br>Ø°ÙÙ‡ÙØ¨Ù Ø§Ù„Ø¸ÙÙ‘Ù…ÙØ£Ù ÙˆÙØ§Ø¨Ù’ØªÙÙ„ÙÙ‘ØªÙ Ø§Ù„Ù’Ø¹ÙØ±ÙÙˆÙ‚ÙØŒ
                    <br>ÙˆÙØ«ÙØ¨ÙØªÙ Ø§Ù„Ø£ÙØ¬Ù’Ø±Ù Ø¥ÙÙ†Ù’ Ø´ÙØ§Ø¡Ù Ø§Ù„Ù„ÙÙ‘Ù‡
                </p>
                <div class="text-center text-xs text-fuchsia-400/50 font-amiri">Ø±ÙˆØ§Ù‡ Ø£Ø¨Ùˆ Ø¯Ø§ÙˆØ¯</div>
            </div>

            <!-- Ø¯Ø¹Ø§Ø¡ Ù„ÙŠÙ„Ø© Ø§Ù„Ù‚Ø¯Ø± -->
            <div class="glass-card rounded-3xl p-5 relative overflow-hidden">
                <div class="flex items-center gap-3 pb-3 border-b border-fuchsia-500/15 mb-4">
                    <span class="text-2xl">ğŸŒ™</span>
                    <h3 class="font-bold text-xl font-kufi text-fuchsia-300">Ø¯ÙØ¹ÙØ§Ø¡Ù Ù„ÙÙŠÙ’Ù„ÙØ©Ù Ø§Ù„Ù’Ù‚ÙØ¯Ù’Ø±</h3>
                </div>
                <p class="font-amiri text-2xl text-white leading-[2.4] text-center tracking-wide">
                    Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ Ø¥ÙÙ†ÙÙ‘ÙƒÙ Ø¹ÙÙÙÙˆÙŒÙ‘ ÙƒÙØ±ÙÙŠÙ…ØŒ
                    <br>ØªÙØ­ÙØ¨ÙÙ‘ Ø§Ù„Ù’Ø¹ÙÙÙ’ÙˆÙ ÙÙØ§Ø¹Ù’ÙÙ Ø¹ÙÙ†ÙÙ‘ÙŠ
                </p>
                <div class="text-center text-xs text-fuchsia-400/50 font-amiri mt-3">Ø±ÙˆØ§Ù‡ Ø§Ù„ØªØ±Ù…Ø°ÙŠ ÙˆØµØ­Ø­Ù‡</div>
            </div>

            <!-- Ø£Ø¯Ø¹ÙŠØ© Ù…Ø®ØªØ§Ø±Ø© -->
            <div class="glass-card rounded-3xl p-5 space-y-4">
                <div class="flex items-center gap-3 pb-3 border-b border-fuchsia-500/15">
                    <i class="fas fa-book-open text-xl text-fuchsia-400"></i>
                    <h3 class="font-bold text-xl font-kufi text-white">Ø£ÙØ¯Ù’Ø¹ÙÙŠÙØ©ÙŒ Ù…ÙØ®Ù’ØªÙØ§Ø±ÙØ©</h3>
                </div>
                <div class="space-y-3">
                    <div class="dua-card p-4 bg-black/30 rounded-2xl border border-white/5 hover:border-fuchsia-500/30 active:scale-[0.98] transition-all cursor-pointer text-right" onclick="window.copyDua(this)">
                        <p class="font-amiri text-xl text-white leading-[2.2]">Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ Ø£ÙØ¹ÙÙ†ÙÙ‘ÙŠ Ø¹ÙÙ„ÙÙ‰ Ø°ÙÙƒÙ’Ø±ÙÙƒÙ ÙˆÙØ´ÙÙƒÙ’Ø±ÙÙƒÙ ÙˆÙØ­ÙØ³Ù’Ù†Ù Ø¹ÙØ¨ÙØ§Ø¯ÙØªÙÙƒ</p>
                        <div class="text-xs text-fuchsia-400/40 font-kufi mt-2 flex items-center gap-1"><i class="fas fa-copy text-[10px]"></i> Ø§Ø¶ØºØ·ÙŠ Ù„Ù„Ù†Ø³Ø®</div>
                    </div>
                    <div class="dua-card p-4 bg-black/30 rounded-2xl border border-white/5 hover:border-fuchsia-500/30 active:scale-[0.98] transition-all cursor-pointer text-right" onclick="window.copyDua(this)">
                        <p class="font-amiri text-xl text-white leading-[2.2]">Ø±ÙØ¨ÙÙ‘Ù†ÙØ§ Ø¢ØªÙÙ†ÙØ§ ÙÙÙŠ Ø§Ù„Ø¯ÙÙ‘Ù†Ù’ÙŠÙØ§ Ø­ÙØ³ÙÙ†ÙØ©Ù‹ ÙˆÙÙÙÙŠ Ø§Ù„Ù’Ø¢Ø®ÙØ±ÙØ©Ù Ø­ÙØ³ÙÙ†ÙØ©Ù‹ ÙˆÙÙ‚ÙÙ†ÙØ§ Ø¹ÙØ°ÙØ§Ø¨Ù Ø§Ù„Ù†ÙÙ‘Ø§Ø±</p>
                        <div class="text-xs text-fuchsia-400/40 font-kufi mt-2 flex items-center gap-1"><i class="fas fa-copy text-[10px]"></i> Ø§Ø¶ØºØ·ÙŠ Ù„Ù„Ù†Ø³Ø®</div>
                    </div>
                    <div class="dua-card p-4 bg-black/30 rounded-2xl border border-white/5 hover:border-fuchsia-500/30 active:scale-[0.98] transition-all cursor-pointer text-right" onclick="window.copyDua(this)">
                        <p class="font-amiri text-xl text-white leading-[2.2]">Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ Ø§Ù‡Ù’Ø¯ÙÙ†ÙÙŠ ÙˆÙØ³ÙØ¯ÙÙ‘Ø¯Ù’Ù†ÙÙŠØŒ Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ Ø¥ÙÙ†ÙÙ‘ÙŠ Ø£ÙØ³Ù’Ø£ÙÙ„ÙÙƒÙ Ø§Ù„Ù’Ù‡ÙØ¯ÙÙ‰ ÙˆÙØ§Ù„Ø³ÙÙ‘Ø¯ÙØ§Ø¯</p>
                        <div class="text-xs text-fuchsia-400/40 font-kufi mt-2 flex items-center gap-1"><i class="fas fa-copy text-[10px]"></i> Ø§Ø¶ØºØ·ÙŠ Ù„Ù„Ù†Ø³Ø®</div>
                    </div>
                    <div class="dua-card p-4 bg-black/30 rounded-2xl border border-white/5 hover:border-fuchsia-500/30 active:scale-[0.98] transition-all cursor-pointer text-right" onclick="window.copyDua(this)">
                        <p class="font-amiri text-xl text-white leading-[2.2]">Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ ØªÙÙ‚ÙØ¨ÙÙ‘Ù„Ù’ ØµÙÙŠÙØ§Ù…ÙÙ†ÙØ§ ÙˆÙÙ‚ÙÙŠÙØ§Ù…ÙÙ†ÙØ§ ÙˆÙØ§Ø¬Ù’Ø¹ÙÙ„Ù’Ù†ÙØ§ Ù…ÙÙ†Ù’ Ø¹ÙØªÙÙ‚ÙØ§Ø¦ÙÙƒÙ Ù…ÙÙ†Ù Ø§Ù„Ù†ÙÙ‘Ø§Ø±</p>
                        <div class="text-xs text-fuchsia-400/40 font-kufi mt-2 flex items-center gap-1"><i class="fas fa-copy text-[10px]"></i> Ø§Ø¶ØºØ·ÙŠ Ù„Ù„Ù†Ø³Ø®</div>
                    </div>
                    <div class="dua-card p-4 bg-black/30 rounded-2xl border border-white/5 hover:border-fuchsia-500/30 active:scale-[0.98] transition-all cursor-pointer text-right" onclick="window.copyDua(this)">
                        <p class="font-amiri text-xl text-white leading-[2.2]">Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ Ø¥ÙÙ†ÙÙ‘ÙŠ Ø£ÙØ³Ù’Ø£ÙÙ„ÙÙƒÙ Ø§Ù„Ù’Ø¬ÙÙ†ÙÙ‘Ø©Ù ÙˆÙÙ…ÙØ§ Ù‚ÙØ±ÙÙ‘Ø¨Ù Ø¥ÙÙ„ÙÙŠÙ’Ù‡ÙØ§ Ù…ÙÙ†Ù’ Ù‚ÙÙˆÙ’Ù„Ù Ø£ÙÙˆÙ’ Ø¹ÙÙ…ÙÙ„ØŒ ÙˆÙØ£ÙØ¹ÙÙˆØ°Ù Ø¨ÙÙƒÙ Ù…ÙÙ†Ù Ø§Ù„Ù†ÙÙ‘Ø§Ø±Ù ÙˆÙÙ…ÙØ§ Ù‚ÙØ±ÙÙ‘Ø¨Ù Ø¥ÙÙ„ÙÙŠÙ’Ù‡ÙØ§ Ù…ÙÙ†Ù’ Ù‚ÙÙˆÙ’Ù„Ù Ø£ÙÙˆÙ’ Ø¹ÙÙ…ÙÙ„</p>
                        <div class="text-xs text-fuchsia-400/40 font-kufi mt-2 flex items-center gap-1"><i class="fas fa-copy text-[10px]"></i> Ø§Ø¶ØºØ·ÙŠ Ù„Ù„Ù†Ø³Ø®</div>
                    </div>
                    <div class="dua-card p-4 bg-black/30 rounded-2xl border border-white/5 hover:border-fuchsia-500/30 active:scale-[0.98] transition-all cursor-pointer text-right" onclick="window.copyDua(this)">
                        <p class="font-amiri text-xl text-white leading-[2.2]">Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ Ø¨ÙÙ„ÙÙ‘ØºÙ’Ù†ÙØ§ Ø±ÙÙ…ÙØ¶ÙØ§Ù†ØŒ ÙˆÙØ¨ÙÙ„ÙÙ‘ØºÙ’Ù†ÙØ§ Ù„ÙÙŠÙ’Ù„ÙØ©Ù Ø§Ù„Ù’Ù‚ÙØ¯Ù’Ø±ØŒ ÙˆÙØ§Ø¬Ù’Ø¹ÙÙ„Ù’Ù†ÙØ§ Ù…ÙÙ†Ù Ø§Ù„Ù’ÙÙØ§Ø¦ÙØ²ÙÙŠÙ†</p>
                        <div class="text-xs text-fuchsia-400/40 font-kufi mt-2 flex items-center gap-1"><i class="fas fa-copy text-[10px]"></i> Ø§Ø¶ØºØ·ÙŠ Ù„Ù„Ù†Ø³Ø®</div>
                    </div>
                </div>
            </div>

            <!-- ØµØ¯Ù‚Ø© Ø¬Ø§Ø±ÙŠØ© -->
            <div class="glass-card p-6 rounded-3xl relative overflow-hidden text-center">
                <div class="absolute top-0 right-0 w-32 h-32 bg-fuchsia-500/5 rounded-full blur-3xl"></div>
                <div class="text-base font-bold text-fuchsia-400 mb-4 font-kufi">ğŸ’œ ØµÙØ¯ÙÙ‚ÙØ©ÙŒ Ø¬ÙØ§Ø±ÙÙŠÙØ©</div>
                <p class="font-amiri text-xl text-white/85 leading-[2.4] relative z-10 mb-6 tracking-wide">
                    Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ Ø§ØºÙ’ÙÙØ±Ù’ Ù„ÙÙ…ÙÙˆÙ’ØªÙØ§Ù†ÙØ§ ÙˆÙÙ…ÙÙˆÙ’ØªÙÙ‰ Ø§Ù„Ù’Ù…ÙØ³Ù’Ù„ÙÙ…ÙÙŠÙ†ØŒ
                    <br>ÙˆÙØ§Ø±Ù’Ø­ÙÙ…Ù’Ù‡ÙÙ…Ù’ Ø¨ÙØ±ÙØ­Ù’Ù…ÙØªÙÙƒÙ Ø§Ù„ÙÙ‘ØªÙÙŠ ÙˆÙØ³ÙØ¹ÙØªÙ’ ÙƒÙÙ„ÙÙ‘ Ø´ÙÙŠÙ’Ø¡ØŒ
                    <br>ÙˆÙØ§Ø¬Ù’Ø¹ÙÙ„Ù’ Ù‚ÙØ¨ÙÙˆØ±ÙÙ‡ÙÙ…Ù’ Ø±ÙÙˆÙ’Ø¶ÙØ©Ù‹ Ù…ÙÙ†Ù’ Ø±ÙÙŠÙØ§Ø¶Ù Ø§Ù„Ù’Ø¬ÙÙ†ÙÙ‘Ø©
                </p>
                <div class="font-amiri text-xl font-bold text-white space-y-3 leading-relaxed relative z-10">
                    <div class="py-2 border-b border-fuchsia-500/15">Ø¹ÙØ·ÙÙŠÙÙ‘Ø© Ø¥ÙØ¨Ù’Ø±ÙØ§Ù‡ÙÙŠÙ…</div>
                    <div class="text-fuchsia-200 py-2 border-b border-fuchsia-500/15">Ø£ÙØ­Ù’Ù…ÙØ¯ Ù…ÙØ­ÙÙ…ÙÙ‘Ø¯ Ø§Ù„Ø³ÙÙ‘ÙŠÙÙ‘Ø¯ Ø¹ÙÙ„ÙÙŠÙˆÙÙ‡</div>
                    <div class="py-2">Ø­ÙÙ…Ù’Ø²ÙØ© Ù…ÙØ­ÙÙ…ÙÙ‘Ø¯ Ø¥ÙØ¨Ù’Ø±ÙØ§Ù‡ÙÙŠÙ…</div>
                </div>
            </div>

            ${FOOTER_HTML}
        </div>`;
    }

    /* â”€â”€ Setup â”€â”€ */
    window.selectSetupTheme = (t) => {
        const mEl = document.getElementById('themeMale');
        const fEl = document.getElementById('themeFemale');
        if (mEl) { mEl.classList.remove('selected-male','selected-female','border-amber-500/40','border-fuchsia-500/25'); mEl.classList.add('border-amber-500/25'); }
        if (fEl) { fEl.classList.remove('selected-male','selected-female','border-amber-500/40','border-fuchsia-500/25'); fEl.classList.add('border-fuchsia-500/15'); }
        if (t === 'male' && mEl) { mEl.classList.remove('border-amber-500/25'); mEl.classList.add('selected-male'); }
        else if (t === 'female' && fEl) { fEl.classList.remove('border-fuchsia-500/15'); fEl.classList.add('selected-female'); }
        currentTheme = t;
    };

    window.finishSetup = async () => {
        const name = document.getElementById('setupName').value.trim();
        if (!name) return showToast('Ø§Ù„Ø§Ø³Ù… ÙŠØ²ÙŠÙ† ØªØ·Ø¨ÙŠÙ‚Ù†Ø§.. ÙØ¶Ù„Ø§Ù‹ Ø£Ø¯Ø®Ù„Ù‡');
        currentUser = name;
        localStorage.setItem('ramadanUserName', name);
        localStorage.setItem('ramadanUserTheme', currentTheme);
        await setDoc(doc(db,"users",name),{username:name,theme:currentTheme,appData:{}},{merge:true});
        location.reload();
    };

    /* â”€â”€ Nav â”€â”€ */
    window.toggleView = (view) => {
        ['dashboard','duaa','quran'].forEach(v => document.getElementById(`${v}-view`)?.classList.add('hidden'));
        document.querySelectorAll('.nav-item').forEach(el => {
            el.classList.remove('text-amber-500','text-fuchsia-400');
            el.classList.add('text-white/50');
        });
        document.getElementById(`${view}-view`)?.classList.remove('hidden');
        const activeColor = currentTheme === 'male' ? 'text-amber-500' : 'text-fuchsia-400';
        const navEl = document.getElementById(`nav-${view}`);
        if (navEl) { navEl.classList.remove('text-white/50'); navEl.classList.add(activeColor); }
        window.scrollTo({ top: 0, behavior: 'smooth' });
    };

    /* â”€â”€ Date â”€â”€ */
    window.changeDate = (d) => {
        const date = new Date(currentDate);
        date.setDate(date.getDate() - d);
        currentDate = date.toISOString().split('T')[0];
        updateUI();
    };

    /* â”€â”€ Prayers â”€â”€ */
    window.togglePrayer = (key, type) => {
        if (!appData[currentDate]) appData[currentDate] = { prayers: {} };
        if (!appData[currentDate].prayers) appData[currentDate].prayers = {};
        if (!appData[currentDate].prayers[key]) appData[currentDate].prayers[key] = {};
        appData[currentDate].prayers[key][type] = !appData[currentDate].prayers[key][type];
        markUnsaved();
        updateUI();
        // Haptic-like visual feedback
        const btn = document.getElementById(`btn-${key}-${type}`);
        if (btn) { btn.classList.add('animate-pop'); setTimeout(() => btn.classList.remove('animate-pop'), 400); }
    };

    /* â”€â”€ Habits â”€â”€ */
    window.toggleHabit = (id) => {
        if (!appData[currentDate]) appData[currentDate] = {};
        appData[currentDate][id] = !appData[currentDate][id];
        markUnsaved();
        updateUI();
    };

    /* â”€â”€ Input change â”€â”€ */
    window.onInputChange = () => markUnsaved();

    /* â”€â”€ Init prayers UI â”€â”€ */
    function initPrayersUI() {
        const list = document.getElementById('prayersList');
        if (!list) return;
        list.innerHTML = '';
        Object.keys(PRAYERS_CONFIG).forEach(key => {
            const p = PRAYERS_CONFIG[key];
            const icon = PRAYER_ICONS[key] || 'fa-circle';
            list.innerHTML += `
            <div class="prayer-row" id="row-${key}">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 rounded-xl flex items-center justify-center flex-shrink-0 ${currentTheme==='male'?'bg-amber-500/10':'bg-fuchsia-500/10'}">
                        <i class="fas ${icon} ${currentTheme==='male'?'text-amber-400':'text-fuchsia-400'} text-sm"></i>
                    </div>
                    <span class="text-lg font-bold font-amiri text-white">${p.label}</span>
                </div>
                <div class="flex gap-2">
                    ${p.fard ? `<button onclick="window.togglePrayer('${key}','fard')" id="btn-${key}-fard" class="prayer-btn font-kufi">ÙØ±Ø¶</button>` : ''}
                    ${p.sunnah ? `<button onclick="window.togglePrayer('${key}','sunnah')" id="btn-${key}-sunnah" class="prayer-btn font-amiri">Ø³Ù†Ø©</button>` : ''}
                </div>
            </div>`;
        });
    }

    /* â”€â”€ Update UI â”€â”€ */
    function updateUI() {
        const today = new Date().toISOString().split('T')[0];
        const dateObj = new Date(currentDate);
        const options = { weekday: 'long', day: 'numeric', month: 'long' };
        const dateEl = document.getElementById('dateDisplay');
        const tagEl = document.getElementById('dateTag');
        if (dateEl) dateEl.textContent = dateObj.toLocaleDateString('ar-EG', options);
        if (tagEl) tagEl.textContent = currentDate === today ? 'Ø§Ù„ÙŠÙˆÙ…' : currentDate < today ? 'ÙŠÙˆÙ… Ø³Ø§Ø¨Ù‚' : 'ÙŠÙˆÙ… Ù‚Ø§Ø¯Ù…';

        const day = appData[currentDate] || {};
        const prayers = day.prayers || {};

        let fardDone = 0, fardTotal = 0;
        Object.keys(PRAYERS_CONFIG).forEach(key => {
            const state = prayers[key] || {};
            const p = PRAYERS_CONFIG[key];
            if (p.fard) fardTotal++;

            const fBtn = document.getElementById(`btn-${key}-fard`);
            const sBtn = document.getElementById(`btn-${key}-sunnah`);
            const row = document.getElementById(`row-${key}`);

            if (fBtn) {
                if (state.fard) {
                    fardDone++;
                    fBtn.className = `prayer-btn font-kufi ${currentTheme==='male'?'btn-fard-done':'btn-fard-done-f'}`;
                } else {
                    fBtn.className = 'prayer-btn font-kufi';
                }
            }
            if (sBtn) {
                if (state.sunnah) {
                    sBtn.className = `prayer-btn font-amiri ${currentTheme==='male'?'btn-sunnah-done':'btn-sunnah-done-f'}`;
                } else {
                    sBtn.className = 'prayer-btn font-amiri';
                }
            }
            if (row) {
                const doneClass = currentTheme==='male' ? 'row-done-m' : 'row-done-f';
                if (state.fard) row.classList.add(doneClass); else row.classList.remove(doneClass);
            }
        });

        // Prayer progress badge
        const ppEl = document.getElementById('prayerProgress');
        if (ppEl) ppEl.textContent = `${fardDone}/${fardTotal} ÙØ±ÙˆØ¶`;

        // Habits
        const habits = currentTheme === 'male'
            ? ['m_morning','m_evening','m_taraweeh']
            : ['f_morning','f_evening','f_taraweeh'];

        habits.forEach(h => {
            const el = document.getElementById(h);
            if (!el) return;
            const circle = el.querySelector('.check-circle');
            const checkIcon = el.querySelector('i.fa-check');
            const activeClass = currentTheme === 'male' ? 'habit-active-m' : 'habit-active-f';
            const circleBg = currentTheme === 'male' ? 'bg-amber-400' : 'bg-fuchsia-400';
            const circleBorder = currentTheme === 'male' ? 'border-amber-400' : 'border-fuchsia-400';

            if (day[h]) {
                el.classList.add(activeClass);
                circle?.classList.add(circleBg, circleBorder);
                if (checkIcon) { checkIcon.classList.remove('opacity-0'); checkIcon.classList.add('opacity-100'); }
            } else {
                el.classList.remove(activeClass);
                circle?.classList.remove(circleBg, circleBorder);
                if (checkIcon) { checkIcon.classList.add('opacity-0'); checkIcon.classList.remove('opacity-100'); }
            }
        });

        const qi = document.getElementById('quranInput');
        const wi = document.getElementById('workInput');
        if (qi) qi.value = day.quran || '';
        if (wi) wi.value = day.work || '';

        updateDashboard();
    }

    /* â”€â”€ Dashboard stats â”€â”€ */
    function updateDashboard() {
        let totalQ=0, totalFard=0, totalSunnah=0, totalTaraweeh=0;
        let daysTracked = Math.max(Object.keys(appData).length, 1);

        // Today's performance
        const cd = appData[currentDate] || {};
        let dFard=0, dSunnah=0;
        Object.keys(PRAYERS_CONFIG).forEach(k => {
            if (PRAYERS_CONFIG[k].fard && cd.prayers?.[k]?.fard) dFard++;
            if (PRAYERS_CONFIG[k].sunnah && cd.prayers?.[k]?.sunnah) dSunnah++;
        });
        const dTaraweeh = (cd.m_taraweeh || cd.f_taraweeh) ? 1 : 0;

        // Month totals
        Object.values(appData).forEach(day => {
            totalQ += (day.quran || 0);
            if (day.prayers) {
                Object.keys(PRAYERS_CONFIG).forEach(k => {
                    if (PRAYERS_CONFIG[k].fard && day.prayers[k]?.fard) totalFard++;
                    if (PRAYERS_CONFIG[k].sunnah && day.prayers[k]?.sunnah) totalSunnah++;
                });
            }
            if (day.m_taraweeh || day.f_taraweeh) totalTaraweeh++;
        });

        // Daily ring
        const dailyPerf = Math.round(((dFard/5)*0.6 + (dSunnah/5)*0.2 + dTaraweeh*0.2)*100);
        const dashLen = 691;
        const ring = document.getElementById('performanceRing');
        if (ring) ring.style.strokeDashoffset = dashLen - (dashLen * Math.min(dailyPerf,100)) / 100;
        const pPct = document.getElementById('performancePct');
        const pLabel = document.getElementById('performanceLabel');
        if (pPct) pPct.textContent = Math.min(dailyPerf,100) + '%';
        if (pLabel) {
            let label = 'Ø³Ø¹ÙŠÙŒ Ø·ÙŠÙÙ‘Ø¨';
            if (dailyPerf >= 40) label = 'Ù‚ÙØ±Ø¨ÙŒ Ø¬Ù…ÙŠÙ„';
            if (dailyPerf >= 70) label = 'Ù†ÙˆØ±ÙŒ Ø¹Ù„Ù‰ Ù†ÙˆØ±';
            if (dailyPerf >= 90) label = 'Ø±ÙÙˆØ­ÙŒ ÙˆØ±ÙŠØ­Ø§Ù†';
            pLabel.textContent = label;
        }

        // Month stats
        const mF = document.getElementById('monthFard');
        const mS = document.getElementById('monthSunnah');
        const mT = document.getElementById('monthTaraweeh');
        const mSc = document.getElementById('monthScore');
        if (mF) mF.textContent = totalFard;
        if (mS) mS.textContent = totalSunnah;
        if (mT) mT.textContent = totalTaraweeh;
        if (mSc) {
            const score = Math.round((totalFard/(daysTracked*5)*0.6 + totalSunnah/(daysTracked*5)*0.2 + totalTaraweeh/daysTracked*0.2)*100);
            mSc.textContent = Math.min(score,100) + '%';
        }

        // Khatma
        const cQ = totalQ % 604;
        const bar = document.getElementById('khatmaBar');
        if (bar) bar.style.width = (cQ/604*100) + '%';
        const cpEl = document.getElementById('currentPages');
        const rpEl = document.getElementById('remainingPages');
        const kLabel = document.getElementById('khatmaLabel');
        if (cpEl) cpEl.textContent = cQ;
        if (rpEl) rpEl.textContent = 604 - cQ;
        if (kLabel) kLabel.textContent = 'Ø§Ù„Ø¬Ø²Ø¡ ' + (Math.floor(totalQ/20) + 1);

        // Streak
        let streak = 0;
        const dates = Object.keys(appData).sort().reverse();
        for (const d of dates) {
            const day = appData[d];
            const allFard = Object.keys(PRAYERS_CONFIG).every(k => !PRAYERS_CONFIG[k].fard || day.prayers?.[k]?.fard);
            if (allFard) streak++; else break;
        }
        const sc = document.getElementById('streakCount');
        if (sc) sc.textContent = streak;
    }

    /* â”€â”€ Save â”€â”€ */
    window.saveData = async () => {
        const quran = parseInt(document.getElementById('quranInput')?.value) || 0;
        const work = parseFloat(document.getElementById('workInput')?.value) || 0;
        if (!appData[currentDate]) appData[currentDate] = {};
        appData[currentDate].quran = quran;
        appData[currentDate].work = work;

        const btn = document.getElementById('saveBtn');
        if (btn) { btn.textContent = 'â³ ÙŠÙØ³Ø¬ÙÙ‘Ù„ Ø³Ø¹ÙŠÙÙƒ..'; btn.disabled = true; }

        try {
            await updateDoc(doc(db,"users",currentUser),{ appData });
            localStorage.setItem('ramadanTrackerData_v5', JSON.stringify(appData));
            showToast('ØªÙ‚Ø¨Ù„ Ø§Ù„Ù„Ù‡ Ù…Ù†Ùƒ ØµØ§Ù„Ø­ Ø§Ù„Ø£Ø¹Ù…Ø§Ù„ âœ¨');
            if (quran > 0) confetti({ particleCount: 120, spread: 70, origin: { y: 0.7 }, colors: ['#fbbf24','#f59e0b','#fff'] });
            markSaved();
        } catch {
            localStorage.setItem('ramadanTrackerData_v5', JSON.stringify(appData));
            showToast('ØªÙ… Ø§Ù„Ø­ÙØ¸ Ø¹Ù„Ù‰ Ø§Ù„Ø¬Ù‡Ø§Ø² Ø¨Ù†Ø¬Ø§Ø­ âœ“');
            markSaved();
        } finally {
            if (btn) {
                btn.textContent = currentTheme === 'male' ? 'ğŸ’¾ Ø­ÙØ¸ ÙŠÙˆÙ…ÙŠØ§ØªÙŠ' : 'âœ¨ Ø­ÙØ¸ ÙŠÙˆÙ…ÙŠØ§ØªÙŠ';
                btn.disabled = false;
            }
            updateDashboard();
        }
    };

    /* â”€â”€ Reset / Home â”€â”€ */
    window.goHome = () => {
        if (confirm('Ù‡Ù„ ØªÙˆØ¯ Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„ØªØºÙŠÙŠØ± Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø§Ù„Ù†Ù…Ø·ØŸ Ø³Ø¬Ù„Ø§ØªÙƒ Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ù„Ù† ØªØ¶ÙŠØ¹.')) {
            document.getElementById('app-container').classList.add('hidden');
            document.getElementById('welcomeScreen').style.display = 'flex';
        }
    };
    window.resetData = () => {
        if (confirm('ØªØ­Ø°ÙŠØ±: Ø³ÙŠØªÙ… Ø­Ø°Ù ÙƒØ§ÙØ© Ø³Ø¬Ù„Ø§ØªÙƒ Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹. Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ØŸ')) {
            localStorage.clear(); location.reload();
        }
    };

    /* â”€â”€ Load app â”€â”€ */
    function loadApp() {
        const container = document.getElementById('app-container');
        document.body.className = `min-h-screen text-zinc-100 theme-${currentTheme}`;
        container.innerHTML = currentTheme === 'male' ? getMaleTemplate() : getFemaleTemplate();
        initPrayersUI();
        updateUI();
        document.getElementById('loadingScreen')?.classList.add('hidden');
        container.classList.remove('hidden');
        setTimeout(() => container.classList.add('opacity-100'), 50);
    }

    /* â”€â”€ Init â”€â”€ */
    function init() {
        if (currentUser) fetchData();
        else {
            document.getElementById('loadingScreen')?.classList.add('hidden');
            document.getElementById('welcomeScreen').style.display = 'flex';
        }
    }
    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       PRAYER TIMES CALCULATOR (Egyptian method)
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    const CITIES = {
        cairo:    { lat: 30.0444, lng: 31.2357, name: 'Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©'     },
        alex:     { lat: 31.2001, lng: 29.9187, name: 'Ø§Ù„Ø¥Ø³ÙƒÙ†Ø¯Ø±ÙŠØ©'  },
        mansoura: { lat: 31.0409, lng: 31.3785, name: 'Ø§Ù„Ù…Ù†ØµÙˆØ±Ø©'    },
    };
    let selectedCity = 'cairo';
    let iftarTimerInterval = null;

    function calcPrayerTimes(lat, lng, dateObj) {
        const rad = d => d * Math.PI / 180;
        const deg = r => r * 180 / Math.PI;
        const Y = dateObj.getFullYear(), M = dateObj.getMonth()+1, D = dateObj.getDate();
        const JD = (367*Y) - Math.floor(7*(Y+Math.floor((M+9)/12))/4)
                   + Math.floor(275*M/9) + D + 1721013.5 + 0.5 - lng/360;
        const d2 = JD - 2451545.0;
        const g  = rad(357.529 + 0.98560028 * d2);
        const q  = 280.459 + 0.98564736 * d2;
        const L  = rad(q + 1.915*Math.sin(g) + 0.020*Math.sin(2*g));
        const e  = rad(23.439 - 0.00000036 * d2);
        const RA = deg(Math.atan2(Math.cos(e)*Math.sin(L), Math.cos(L))) / 15;
        const decl = deg(Math.asin(Math.sin(e)*Math.sin(L)));
        const EqT  = q/15 - (RA - 24*Math.floor(RA/24));
        const tz   = 2; // EET
        const transit = 12 + tz - lng/15 - EqT;

        function ha(angle) {
            const cosH = (Math.sin(rad(angle)) - Math.sin(rad(lat))*Math.sin(rad(decl)))
                       / (Math.cos(rad(lat))*Math.cos(rad(decl)));
            if (Math.abs(cosH) > 1) return NaN;
            return deg(Math.acos(cosH)) / 15;
        }

        function asrHA() {
            const angle = -deg(Math.atan(1 / (1 + Math.tan(rad(Math.abs(lat - decl))))));
            return ha(angle);
        }

        function fmt(h) {
            if (isNaN(h)) return '--:--';
            h = ((h % 24) + 24) % 24;
            const hh = Math.floor(h), mm = Math.round((h - hh)*60);
            const hFix = mm === 60 ? (hh+1)%24 : hh;
            const mFix = mm === 60 ? 0 : mm;
            const ap = hFix >= 12 ? 'Ù…' : 'Øµ';
            const h12 = hFix % 12 || 12;
            return `${h12}:${String(mFix).padStart(2,'0')} ${ap}`;
        }

        const fajrH    = transit - ha(-19.5);
        const sunriseH = transit - ha(-0.8333);
        const dhuhrH   = transit;
        const asrH     = transit + asrHA();
        const maghribH = transit + ha(-0.8333);
        const ishaH    = transit + ha(-17.5);

        return {
            fajr:    { fmt: fmt(fajrH),    raw: fajrH    },
            sunrise: { fmt: fmt(sunriseH), raw: sunriseH },
            dhuhr:   { fmt: fmt(dhuhrH),   raw: dhuhrH   },
            asr:     { fmt: fmt(asrH),     raw: asrH     },
            maghrib: { fmt: fmt(maghribH), raw: maghribH },
            isha:    { fmt: fmt(ishaH),    raw: ishaH    },
        };
    }

    function renderPrayerTimes(city) {
        const c = CITIES[city];
        const now = new Date();
        const times = calcPrayerTimes(c.lat, c.lng, now);

        document.getElementById('az-fajr').textContent    = times.fajr.fmt;
        document.getElementById('az-sunrise').textContent = times.sunrise.fmt;
        document.getElementById('az-dhuhr').textContent   = times.dhuhr.fmt;
        document.getElementById('az-asr').textContent     = times.asr.fmt;
        document.getElementById('az-maghrib').textContent = times.maghrib.fmt;
        document.getElementById('az-isha').textContent    = times.isha.fmt;

        // Date label
        const dateLabel = document.getElementById('azanDateLabel');
        if (dateLabel) {
            dateLabel.textContent = now.toLocaleDateString('ar-EG', { weekday:'long', day:'numeric', month:'long' });
        }

        // Iftar countdown
        startIftarCountdown(times.maghrib.raw);
    }

    function startIftarCountdown(maghribRaw) {
        if (iftarTimerInterval) clearInterval(iftarTimerInterval);
        const cdEl = document.getElementById('iftarCountdown');
        const cdText = document.getElementById('iftarCountdownText');
        if (!cdEl || !cdText) return;

        function tick() {
            const now = new Date();
            const nowH = now.getHours() + now.getMinutes()/60 + now.getSeconds()/3600;
            const diff = maghribRaw - nowH;
            if (diff > 0 && diff < 12) {
                const totalSec = Math.round(diff * 3600);
                const h = Math.floor(totalSec / 3600);
                const m = Math.floor((totalSec % 3600) / 60);
                const s = totalSec % 60;
                cdEl.classList.remove('hidden');
                if (h > 0) {
                    cdText.textContent = `Ù…ØªØ¨Ù‚ÙŠ Ù„Ù„Ø¥ÙØ·Ø§Ø±: ${h} Ø³ ${m} Ø¯`;
                } else {
                    cdText.textContent = `Ù…ØªØ¨Ù‚ÙŠ Ù„Ù„Ø¥ÙØ·Ø§Ø±: ${m} Ø¯ ${s} Ø«`;
                }
            } else if (diff <= 0 && diff > -0.5) {
                cdEl.classList.remove('hidden');
                cdText.textContent = 'ğŸŒ… Ø­Ø§Ù† ÙˆÙ‚Øª Ø§Ù„Ø¥ÙØ·Ø§Ø±! Ø£ÙÙÙ’Ø·ÙØ±Ù’ Ù‡ÙÙ†ÙÙŠØ¦Ø§Ù‹ Ù…Ø±ÙŠØ¦Ø§Ù‹';
            } else {
                cdEl.classList.add('hidden');
            }
        }
        tick();
        iftarTimerInterval = setInterval(tick, 1000);
    }

    window.selectCity = (city) => {
        selectedCity = city;
        // Update tabs style
        const isMale = currentTheme === 'male';
        const activeClasses = isMale
            ? ['bg-amber-500','text-black','shadow-md']
            : ['bg-fuchsia-500','text-white','shadow-md'];
        const inactiveClasses = ['text-white/50'];
        ['cairo','alex','mansoura'].forEach(c => {
            const tab = document.getElementById(`tab-${c}`);
            if (!tab) return;
            tab.classList.remove(...activeClasses, ...inactiveClasses);
            if (c === city) tab.classList.add(...activeClasses);
            else tab.classList.add(...inactiveClasses);
        });
        renderPrayerTimes(city);
    };

    // Auto-load prayer times when duaa view is opened
    const origToggleView = window.toggleView;
    window.toggleView = (view) => {
        origToggleView(view);
        if (view === 'duaa') {
            setTimeout(() => {
                renderPrayerTimes(selectedCity);
                window.selectCity(selectedCity);
            }, 50);
        }
        if (view === 'quran') {
            setTimeout(() => initQuran(), 50);
        }
    };

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       QURAN READER  (api.alquran.cloud)
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    let surahList = [];
    let currentSurahNum = 1;
    let quranFontSize = 26;
    let quranInitialized = false;

    async function initQuran() {
        if (quranInitialized) return;
        const sel = document.getElementById('surahSelect');
        if (!sel || surahList.length > 0) { quranInitialized = true; return; }
        try {
            const res = await fetch('https://api.alquran.cloud/v1/surah');
            const json = await res.json();
            surahList = json.data;
            surahList.forEach(s => {
                const opt = document.createElement('option');
                opt.value = s.number;
                opt.textContent = `${s.number}. ${s.name} â€” ${s.englishName}`;
                sel.appendChild(opt);
            });
            quranInitialized = true;
            // Auto-load Al-Fatiha
            sel.value = '1';
            window.loadSurah();
        } catch {
            showToast('ØªØ¹Ø°Ù‘Ø± ØªØ­Ù…ÙŠÙ„ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø³ÙˆØ±ØŒ ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª');
        }
    }

    window.loadSurah = async () => {
        const sel = document.getElementById('surahSelect');
        if (!sel || !sel.value) return;
        currentSurahNum = parseInt(sel.value);

        const loading = document.getElementById('quranLoading');
        const container = document.getElementById('quranContainer');
        const navBar = document.getElementById('quranNavBar');
        if (loading) loading.classList.remove('hidden');
        if (container) container.classList.add('hidden');
        if (navBar) navBar.classList.add('hidden');

        try {
            const res = await fetch(`https://api.alquran.cloud/v1/surah/${currentSurahNum}/ar.alafasy`);
            const json = await res.json();
            const surah = json.data;

            if (loading) loading.classList.add('hidden');
            if (container) container.classList.remove('hidden');
            if (navBar) navBar.classList.remove('hidden');

            // Surah info
            const infoEl = document.getElementById('surahInfo');
            const nameEl = document.getElementById('surahNameAr');
            const countEl = document.getElementById('surahVerseCount');
            if (infoEl) infoEl.classList.remove('hidden');
            if (nameEl) nameEl.textContent = surah.name;
            if (countEl) countEl.textContent = `${surah.numberOfAyahs} Ø¢ÙŠØ© Â· ${surah.revelationType === 'Meccan' ? 'Ù…ÙƒÙŠØ©' : 'Ù…Ø¯Ù†ÙŠØ©'}`;

            // Hide bismillah for Al-Fatiha and Al-Tawbah
            const bism = document.getElementById('bismillah');
            if (bism) bism.style.display = (currentSurahNum === 1 || currentSurahNum === 9) ? 'none' : 'block';

            // Render verses
            const versesEl = document.getElementById('quranVerses');
            if (versesEl) {
                versesEl.style.fontSize = quranFontSize + 'px';
                const isMale = currentTheme === 'male';
                versesEl.innerHTML = surah.ayahs.map(a => `
                    <div class="verse-block pb-4 border-b border-white/5 last:border-0">
                        <p class="font-amiri text-white leading-[2.4] text-right mb-1">${a.text}</p>
                        <div class="flex justify-end">
                            <span class="text-xs px-3 py-1 rounded-full ${isMale ? 'bg-amber-500/10 text-amber-400/60' : 'bg-fuchsia-500/10 text-fuchsia-400/60'} font-amiri">
                                ï´¿${toArabicNum(a.numberInSurah)}ï´¾
                            </span>
                        </div>
                    </div>
                `).join('');
            }

            // Nav label
            const navLabel = document.getElementById('quranNavLabel');
            if (navLabel) navLabel.textContent = `${surah.name} (${currentSurahNum}/114)`;

            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });

        } catch {
            if (loading) loading.classList.add('hidden');
            showToast('ØªØ¹Ø°Ù‘Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³ÙˆØ±Ø©ØŒ ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª');
        }
    };

    function toArabicNum(n) {
        return String(n).replace(/\d/g, d => 'Ù Ù¡Ù¢Ù£Ù¤Ù¥Ù¦Ù§Ù¨Ù©'[d]);
    }

    window.changeFontSize = (delta) => {
        quranFontSize = Math.max(18, Math.min(40, quranFontSize + delta * 2));
        const el = document.getElementById('quranVerses');
        if (el) el.style.fontSize = quranFontSize + 'px';
    };

    window.nextSurah = () => {
        if (currentSurahNum >= 114) return;
        currentSurahNum++;
        const sel = document.getElementById('surahSelect');
        if (sel) { sel.value = currentSurahNum; window.loadSurah(); }
    };

    window.prevSurah = () => {
        if (currentSurahNum <= 1) return;
        currentSurahNum--;
        const sel = document.getElementById('surahSelect');
        if (sel) { sel.value = currentSurahNum; window.loadSurah(); }
    };

    /* â”€â”€ Copy Dua â”€â”€ */
    window.copyDua = (el) => {
        const text = el.querySelector('p')?.textContent?.trim();
        if (!text) return;
        navigator.clipboard.writeText(text)
            .then(() => showToast('ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø¯Ø¹Ø§Ø¡ âœ¨'))
            .catch(() => showToast('Ø§Ù„Ø¯Ø¹Ø§Ø¡ ÙÙŠ Ù‚Ù„Ø¨Ùƒ ğŸ¤'));
    };

    /* â”€â”€ legacy fetchAzan kept as no-op â”€â”€ */
    window.fetchAzan = () => {};

    init();
</script>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• NIGHT SKY SCRIPT â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<script>
(function() {
    const canvas = document.getElementById('starCanvas');
    const ctx = canvas.getContext('2d');
    let stars = [];
    let W, H;

    function resize() {
        W = canvas.width = window.innerWidth;
        H = canvas.height = window.innerHeight;
        buildStars();
    }

    function buildStars() {
        stars = [];
        const count = Math.floor((W * H) / 4000);
        for (let i = 0; i < count; i++) {
            stars.push({
                x: Math.random() * W,
                y: Math.random() * H * 0.65, // only upper 65% of screen
                r: Math.random() * 1.4 + 0.3,
                a: Math.random(),
                da: (Math.random() * 0.008 + 0.002) * (Math.random() > 0.5 ? 1 : -1),
                speed: Math.random() * 0.015 + 0.005
            });
        }
    }

    function draw() {
        ctx.clearRect(0, 0, W, H);
        const isFemale = document.body.classList.contains('theme-female');
        stars.forEach(s => {
            s.a += s.da;
            if (s.a > 1) { s.a = 1; s.da *= -1; }
            if (s.a < 0.05) { s.a = 0.05; s.da *= -1; }

            ctx.beginPath();
            ctx.arc(s.x, s.y, s.r, 0, Math.PI * 2);
            ctx.fillStyle = isFemale
                ? `rgba(240, 171, 252, ${s.a * 0.7})`
                : `rgba(255, 240, 200, ${s.a * 0.75})`;
            ctx.fill();

            // subtle glow for bigger stars
            if (s.r > 1.1) {
                ctx.beginPath();
                ctx.arc(s.x, s.y, s.r * 3, 0, Math.PI * 2);
                const grd = ctx.createRadialGradient(s.x, s.y, 0, s.x, s.y, s.r * 3);
                grd.addColorStop(0, isFemale ? `rgba(240,171,252,${s.a * 0.15})` : `rgba(251,191,36,${s.a * 0.15})`);
                grd.addColorStop(1, 'transparent');
                ctx.fillStyle = grd;
                ctx.fill();
            }
        });
        requestAnimationFrame(draw);
    }

    window.addEventListener('resize', resize);
    resize();
    draw();

    // Shooting stars
    function spawnShootingStar() {
        const el = document.createElement('div');
        el.className = 'shooting-star';
        const startX = Math.random() * window.innerWidth * 0.7 + window.innerWidth * 0.2;
        const startY = Math.random() * window.innerHeight * 0.3 + 60;
        const duration = Math.random() * 1500 + 1000;
        el.style.cssText = `top:${startY}px;left:${startX}px;animation-duration:${duration}ms;`;
        document.body.appendChild(el);
        setTimeout(() => el.remove(), duration + 100);
    }

    // Random shooting stars every 6-15 seconds
    function scheduleShoot() {
        setTimeout(() => {
            spawnShootingStar();
            scheduleShoot();
        }, Math.random() * 9000 + 6000);
    }
    scheduleShoot();

    // Update female theme orbs
    document.addEventListener('DOMContentLoaded', () => {
        const orbs = document.querySelectorAll('.bg-orb');
        // watch for theme class changes
        const observer = new MutationObserver(() => {
            const isFemale = document.body.classList.contains('theme-female');
            orbs.forEach((orb, i) => {
                if (isFemale) {
                    const colors = ['rgba(217,70,239,0.12)', 'rgba(168,85,247,0.08)', 'rgba(240,171,252,0.1)'];
                    orb.style.background = colors[i % colors.length];
                } else {
                    const colors = ['rgba(251,191,36,0.15)', 'rgba(251,191,36,0.08)', 'rgba(245,158,11,0.1)'];
                    orb.style.background = colors[i % colors.length];
                }
            });
        });
        observer.observe(document.body, { attributes: true, attributeFilter: ['class'] });
    });
})();
</script>
</body>
</html>
